<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.6" xml:lang="en-US">
  <compounddef id="dataflow__api_8h" kind="file" language="C++">
    <compoundname>dataflow_api.h</compoundname>
    <includes local="no">stdint.h</includes>
    <includes local="yes">core_config.h</includes>
    <includes local="yes">circular_buffer.h</includes>
    <includes local="yes">debug/sanitize_noc.h</includes>
    <includes local="yes">debug/waypoint.h</includes>
    <includes local="yes">eth_l1_address_map.h</includes>
    <includes local="yes">hostdevcommon/common_runtime_address_map.h</includes>
    <includes local="yes">hostdevcommon/common_values.hpp</includes>
    <includes local="yes">risc_attribs.h</includes>
    <includes local="yes">third_party/umd/device/tt_silicon_driver_common.hpp</includes>
    <includes local="yes">debug/assert.h</includes>
    <includes local="yes">dev_msgs.h</includes>
    <includedby refid="ethernet_2dataflow__api_8h" local="yes">tt_metal/hw/inc/ethernet/dataflow_api.h</includedby>
    <incdepgraph>
      <node id="1">
        <label>tt_metal/hw/inc/dataflow_api.h</label>
        <link refid="dataflow__api_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="8" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>circular_buffer.h</label>
      </node>
      <node id="3">
        <label>core_config.h</label>
      </node>
      <node id="12">
        <label>debug/assert.h</label>
      </node>
      <node id="5">
        <label>debug/sanitize_noc.h</label>
      </node>
      <node id="6">
        <label>debug/waypoint.h</label>
      </node>
      <node id="13">
        <label>dev_msgs.h</label>
      </node>
      <node id="7">
        <label>eth_l1_address_map.h</label>
      </node>
      <node id="8">
        <label>hostdevcommon/common_runtime_address_map.h</label>
      </node>
      <node id="9">
        <label>hostdevcommon/common_values.hpp</label>
      </node>
      <node id="10">
        <label>risc_attribs.h</label>
      </node>
      <node id="2">
        <label>stdint.h</label>
      </node>
      <node id="11">
        <label>third_party/umd/device/tt_silicon_driver_common.hpp</label>
      </node>
    </incdepgraph>
    <invincdepgraph>
      <node id="1">
        <label>tt_metal/hw/inc/dataflow_api.h</label>
        <link refid="dataflow__api_8h"/>
        <childnode refid="2" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>tt_metal/hw/inc/ethernet/dataflow_api.h</label>
        <link refid="ethernet_2dataflow__api_8h_source"/>
      </node>
    </invincdepgraph>
    <innerclass refid="structInterleavedAddrGen" prot="public">InterleavedAddrGen</innerclass>
    <innerclass refid="structInterleavedPow2AddrGen" prot="public">InterleavedPow2AddrGen</innerclass>
    <innerclass refid="structInterleavedAddrGenFast" prot="public">InterleavedAddrGenFast</innerclass>
    <innerclass refid="structInterleavedPow2AddrGenFast" prot="public">InterleavedPow2AddrGenFast</innerclass>
    <innernamespace refid="namespaceinterleaved__addr__gen">interleaved_addr_gen</innernamespace>
      <sectiondef kind="define">
      <memberdef kind="define" id="dataflow__api_8h_1a56cf50350ff87477df00fb899480ff2d" prot="public" static="no">
        <name>NOC_UNICAST_WRITE_VC</name>
        <initializer>1</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="43" column="9" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="43" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="dataflow__api_8h_1a5fb39d71d6c419e9ad7aa0f43e5a91d8" prot="public" static="no">
        <name>NOC_MULTICAST_WRITE_VC</name>
        <initializer>4</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="44" column="9" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="44" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="dataflow__api_8h_1a49104913a904db0ef5c642d10a33c923" prot="public" static="no">
        <name>NOC_DISPATCH_MULTICAST_WRITE_VC</name>
        <initializer>5</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="45" column="9" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="45" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="dataflow__api_8h_1ab97f9dbfbb4150cb324f21520b8e6cfe" prot="public" static="no">
        <name>get_compile_time_arg_val</name>
        <param><defname>arg_idx</defname></param>
        <initializer>KERNEL_COMPILE_TIME_ARG_##arg_idx</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns the value of a constexpr argument from kernel_compile_time_args array provided during kernel creation using CreateKernel calls.</para>
<para>Return value: constexpr uint32_t</para>
<para><table rows="2" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>arg_idx   </para>
</entry><entry thead="no"><para>The index of the argument   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 31   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="186" column="9" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="186" bodyend="-1"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="var">
      <memberdef kind="variable" id="dataflow__api_8h_1a58bc3a01e945dbd421fce21906e94441" prot="public" static="no" mutable="no">
        <type>uint8_t</type>
        <definition>uint8_t noc_index</definition>
        <argsstring></argsstring>
        <name>noc_index</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="30" column="16" declfile="tt_metal/hw/inc/dataflow_api.h" declline="30" declcolumn="16"/>
      </memberdef>
      <memberdef kind="variable" id="dataflow__api_8h_1a2366e9251332058fa1fa368903d1d760" prot="public" static="no" mutable="no">
        <type>uint32_t *</type>
        <definition>uint32_t* rta_l1_base</definition>
        <argsstring></argsstring>
        <name>rta_l1_base</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="31" column="18" declfile="tt_metal/hw/inc/dataflow_api.h" declline="31" declcolumn="18"/>
      </memberdef>
      <memberdef kind="variable" id="dataflow__api_8h_1a74c5ca11f2fb15c25af4a74db732a5fc" prot="public" static="no" mutable="no">
        <type>uint32_t *</type>
        <definition>uint32_t* crta_l1_base</definition>
        <argsstring></argsstring>
        <name>crta_l1_base</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="32" column="18" declfile="tt_metal/hw/inc/dataflow_api.h" declline="32" declcolumn="18"/>
      </memberdef>
      <memberdef kind="variable" id="dataflow__api_8h_1a237705982b987907cbfca699e32a9c64" prot="public" static="no" mutable="no">
        <type>uint32_t *</type>
        <definition>uint32_t* sem_l1_base[]</definition>
        <argsstring>[]</argsstring>
        <name>sem_l1_base</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="33" column="18" declfile="tt_metal/hw/inc/dataflow_api.h" declline="33" declcolumn="18"/>
      </memberdef>
      <memberdef kind="variable" id="dataflow__api_8h_1a6738833d9844f57ccbb71859a4b8de05" prot="private" static="no" mutable="no">
        <type>CBInterface</type>
        <definition>CBInterface cb_interface[NUM_CIRCULAR_BUFFERS]</definition>
        <argsstring>[NUM_CIRCULAR_BUFFERS]</argsstring>
        <name>cb_interface</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="40" column="20" declfile="tt_metal/hw/inc/dataflow_api.h" declline="40" declcolumn="20"/>
      </memberdef>
      </sectiondef>
      <sectiondef kind="func">
      <memberdef kind="function" id="dataflow__api_8h_1ac4752c4d9a07974ce99aaa671a675fe2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>uint32_t align</definition>
        <argsstring>(uint32_t addr, uint32_t alignment)</argsstring>
        <name>align</name>
        <param>
          <type>uint32_t</type>
          <declname>addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>alignment</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="48" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="48" bodyend="48"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a25d62dac426c2869489c6a658de97058" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>static uint32_t get_arg_addr</definition>
        <argsstring>(int arg_idx)</argsstring>
        <name>get_arg_addr</name>
        <param>
          <type>int</type>
          <declname>arg_idx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns the address in L1 for a given runtime argument index for unique (per core) runtime arguments set via SetRuntimeArgs() API.</para>
<para>Return value: Associated L1 address of given unique runtime argument index</para>
<para><table rows="2" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>arg_idx   </para>
</entry><entry thead="no"><para>Unique Runtime argument index   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 255   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="123" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="123" bodyend="125"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aca9717f94b44990fc7fca49678eda5a0" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>static uint32_t get_common_arg_addr</definition>
        <argsstring>(int arg_idx)</argsstring>
        <name>get_common_arg_addr</name>
        <param>
          <type>int</type>
          <declname>arg_idx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns the address in L1 for a given runtime argument index for common (all cores) runtime arguments set via SetCommonRuntimeArgs() API.</para>
<para>Return value: Associated L1 address of given common runtime argument index</para>
<para><table rows="2" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>arg_idx   </para>
</entry><entry thead="no"><para>Common Runtime argument index   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 255   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="137" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="137" bodyend="139"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a6a5074e8cd2732fcecab57fced3ebd1f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>typename T</type>
          </param>
        </templateparamlist>
        <type>T</type>
        <definition>T get_arg_val</definition>
        <argsstring>(int arg_idx)</argsstring>
        <name>get_arg_val</name>
        <param>
          <type>int</type>
          <declname>arg_idx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns the value at a given runtime argument index for unique (per-core) runtime arguments set via SetRuntimeArgs() API.</para>
<para>Return value: The value associated with the unique runtime argument index</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>arg_idx   </para>
</entry><entry thead="no"><para>Unique Runtime argument index   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 255   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>T (template argument)   </para>
</entry><entry thead="no"><para>Data type of the returned argument   </para>
</entry><entry thead="no"><para>Any 4-byte sized type   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="152" column="4" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="152" bodyend="156"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1abba486e3732fb5ea715651f92234e60a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>typename T</type>
          </param>
        </templateparamlist>
        <type>T</type>
        <definition>T get_common_arg_val</definition>
        <argsstring>(int arg_idx)</argsstring>
        <name>get_common_arg_val</name>
        <param>
          <type>int</type>
          <declname>arg_idx</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns the value at a given runtime argument index for common (all cores) runtime arguments set via SetCommonRuntimeArgs() API.</para>
<para>Return value: The value associated with the common runtime argument index</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>arg_idx   </para>
</entry><entry thead="no"><para>Common Runtime argument index   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 255   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>T (template argument)   </para>
</entry><entry thead="no"><para>Data type of the returned argument   </para>
</entry><entry thead="no"><para>Any 4-byte sized type   </para>
</entry><entry thead="no"><para>N/A   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="169" column="4" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="169" bodyend="173"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a4f3db5f995cef4fca051fe50ba763889" prot="public" static="yes" constexpr="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>constexpr std::int32_t</type>
        <definition>static constexpr std::int32_t GET_TILE_SIZE</definition>
        <argsstring>(uint format)</argsstring>
        <name>GET_TILE_SIZE</name>
        <param>
          <type>uint</type>
          <declname>format</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="190" column="31" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="190" bodyend="212"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a84882e48fa6e1cafd575fd8414f67adb" prot="public" static="yes" constexpr="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>constexpr std::uint32_t</type>
        <definition>static constexpr std::uint32_t MUL_WITH_TILE_SIZE</definition>
        <argsstring>(uint format, uint index)</argsstring>
        <name>MUL_WITH_TILE_SIZE</name>
        <param>
          <type>uint</type>
          <declname>format</declname>
        </param>
        <param>
          <type>uint</type>
          <declname>index</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="215" column="32" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="215" bodyend="233"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a81357224b88562601b42833eec676ffb" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void cb_push_back</definition>
        <argsstring>(const int32_t operand, const int32_t num_pages)</argsstring>
        <name>cb_push_back</name>
        <param>
          <type>const int32_t</type>
          <declname>operand</declname>
        </param>
        <param>
          <type>const int32_t</type>
          <declname>num_pages</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Pushes a given number of tiles in the back of the specified CB’s queue. Decreases the available space in the circular buffer by this number of tiles. This call is used by the producer to make the tiles visible to the consumer of the CB.</para>
<para>We use the convention that the producer pushes tiles into the “back” of the CB queue and the consumer consumes tiles from the “front” of the CB queue.</para>
<para>Note that the act of writing the tile data into the CB does not make the tiles visible to the consumer. Writing of the tiles and pushing is separated to allow the producer to: 1) write the tile data to the CB via multiple writes of sub-tiles 2) modify tiles (or sub-tiles) by random access of the valid section of the CB</para>
<para>Return value: None</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>cb_id   </para>
</entry><entry thead="no"><para>The index of the circular buffer (CB)   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 31   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>num_tiles   </para>
</entry><entry thead="no"><para>The number of tiles to be pushed   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>It must be less or equal than the size of the CB (the total number of tiles that fit into the CB)   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="258" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="258" bodyend="274"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aa3daf8e5e7299140cf2607be1a8656b0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void cb_pop_front</definition>
        <argsstring>(int32_t operand, int32_t num_pages)</argsstring>
        <name>cb_pop_front</name>
        <param>
          <type>int32_t</type>
          <declname>operand</declname>
        </param>
        <param>
          <type>int32_t</type>
          <declname>num_pages</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Pops a specified number of tiles from the front of the specified CB. This also frees this number of tiles in the circular buffer. This call is used by the consumer to free up the space in the CB.</para>
<para>We use the convention that the producer pushes tiles into the “back” of the CB queue and the consumer consumes tiles from the “front” of the CB queue.</para>
<para>Note that the act of reading of the tile data from the CB does not free up the space in the CB. Waiting on available tiles and popping them is separated in order to allow the consumer to: 1) read the tile data from the CB via multiple reads of sub-tiles 2) access the tiles (or their sub-tiles) that are visible to the consumer by random access of the valid section of the CB</para>
<para>Return value: None</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>cb_id   </para>
</entry><entry thead="no"><para>The index of the circular buffer (CB)   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 31   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>num_tiles   </para>
</entry><entry thead="no"><para>The number of tiles to be popped   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>It must be less or equal than the size of the CB (the total number of tiles that fit into the CB)   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="299" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="299" bodyend="314"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1af4a1a9478a83ad216d826dc5f783d1f8" prot="public" static="no" constexpr="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>constexpr std::int32_t</type>
        <definition>constexpr std::int32_t get_tile_size</definition>
        <argsstring>(const std::int32_t operand)</argsstring>
        <name>get_tile_size</name>
        <param>
          <type>const std::int32_t</type>
          <declname>operand</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="320" column="31" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="320" bodyend="328"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ae214b6c2f978e745f9c24d397dad906d" prot="public" static="no" constexpr="yes" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>constexpr DataFormat</type>
        <definition>constexpr DataFormat get_dataformat</definition>
        <argsstring>(const std::int32_t operand)</argsstring>
        <name>get_dataformat</name>
        <param>
          <type>const std::int32_t</type>
          <declname>operand</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="330" column="29" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="330" bodyend="332"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a593e43aff0c85e4b3f86d13f1d7350dd" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>uint32_t get_write_ptr</definition>
        <argsstring>(uint32_t operand)</argsstring>
        <name>get_write_ptr</name>
        <param>
          <type>uint32_t</type>
          <declname>operand</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns a pointer to the beginning of a memory block previously reserved by cb_reserve_back. Note that this call is only valid between calls to cb_reserve_back and cb_push_back. The amount of valid memory is equal to the number of tiles requested in a prior cb_reserve_back call.</para>
<para>CB total size must be an even multiple of this call.</para>
<para>Return value: None</para>
<para><table rows="2" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>operand   </para>
</entry><entry thead="no"><para>The index of the circular buffer (CB)   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 31   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="351" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="351" bodyend="355"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a66a31715a14cea1a63cbdca8c99b0827" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>uint32_t get_read_ptr</definition>
        <argsstring>(uint32_t operand)</argsstring>
        <name>get_read_ptr</name>
        <param>
          <type>uint32_t</type>
          <declname>operand</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Returns a pointer to the beginning of a memory block previously received by cb_wait_front. Note that this call is only valid between calls to cb_wait_front and cb_pop_front. The amount of valid memory is equal to the number of tiles requested in a prior cb_wait_front call.</para>
<para>Return value: None</para>
<para><table rows="2" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>operand   </para>
</entry><entry thead="no"><para>The index of the circular buffer (CB)   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 31   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="370" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="370" bodyend="375"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1af2384f3c7d9784e3e662093136cbed25" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>void wait_for_sync_register_value</definition>
        <argsstring>(uint32_t addr, int32_t val)</argsstring>
        <name>wait_for_sync_register_value</name>
        <param>
          <type>uint32_t</type>
          <declname>addr</declname>
        </param>
        <param>
          <type>int32_t</type>
          <declname>val</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="377" column="13" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="377" bodyend="385"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a29521dee07b0070674a988f66c01ffed" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void cb_reserve_back</definition>
        <argsstring>(int32_t operand, int32_t num_pages)</argsstring>
        <name>cb_reserve_back</name>
        <param>
          <type>int32_t</type>
          <declname>operand</declname>
        </param>
        <param>
          <type>int32_t</type>
          <declname>num_pages</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>A blocking call that waits for the specified number of tiles to be free in the specified circular buffer. This call is used by the producer to wait for the consumer to consume (ie. free up) the specified number of tiles.</para>
<para>CB total size must be an even multiple of the argument passed to this call.</para>
<para>Return value: None</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>cb_id   </para>
</entry><entry thead="no"><para>The index of the circular buffer (CB)   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 31   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>num_tiles   </para>
</entry><entry thead="no"><para>The number of free tiles to wait for   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>It must be less or equal than the size of the CB (the total number of tiles that fit into the CB)   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="401" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="401" bodyend="426"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1af6d8057bd05a650c3501c5208f7d9f8a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void cb_wait_front</definition>
        <argsstring>(int32_t operand, int32_t num_pages)</argsstring>
        <name>cb_wait_front</name>
        <param>
          <type>int32_t</type>
          <declname>operand</declname>
        </param>
        <param>
          <type>int32_t</type>
          <declname>num_pages</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>A blocking call that waits for the specified number of tiles to be available in the specified circular buffer (CB). This call is used by the consumer of the CB to wait for the producer to fill the CB with at least the specified number of tiles. Important note: in case multiple calls of cb_wait_front(n) are issued without a paired <ref refid="dataflow__api_8h_1aa3daf8e5e7299140cf2607be1a8656b0" kindref="member">cb_pop_front()</ref> call, n is expected to be incremented by the user to be equal to a cumulative total of tiles. Example: 4 calls of cb_wait_front(8) followed by a cb_pop_front(32) would produce incorrect behavior. Instead 4 calls of <ref refid="dataflow__api_8h_1af6d8057bd05a650c3501c5208f7d9f8a" kindref="member">cb_wait_front()</ref> waiting on 8, 16, 24, 32 tiles should be issued.</para>
<para>Important note: number of tiles used in all cb_* calls must evenly divide the cb size and must be the same number in all cb_wait_front calls in the same kernel. Example 1: cb_wait_front(32), cb_wait_front(40), cb_pop_front(32+8) tiles on a CB of size 64 would produce incorrect behavior. Example 2: cb_wait_front(3) on a cb of size 32 would also produce incorrect behavior. These limitations are due to performance optimizations in the CB implementation.</para>
<para>Important note: CB total size must be an even multiple of the argument passed to this call.</para>
<para>Return value: None</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>cb_id   </para>
</entry><entry thead="no"><para>The index of the circular buffer (CB)   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0 to 31   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>num_tiles   </para>
</entry><entry thead="no"><para>The number of tiles to wait for   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>It must be less or equal than the size of the CB (the total number of tiles that fit into the CB)   </para>
</entry><entry thead="no"><para></para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="451" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="451" bodyend="463"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ae4374fb8ab97c23045cf3f9dd8e1615f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>std::uint64_t</type>
        <definition>std::uint64_t get_noc_multicast_addr</definition>
        <argsstring>(std::uint32_t noc_x_start, std::uint32_t noc_y_start, std::uint32_t noc_x_end, std::uint32_t noc_y_end, std::uint32_t addr)</argsstring>
        <name>get_noc_multicast_addr</name>
        <param>
          <type>std::uint32_t</type>
          <declname>noc_x_start</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>noc_y_start</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>noc_x_end</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>noc_y_end</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>addr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="470" column="15" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="470" bodyend="481"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a6080fdaa08b51535164a0b439599c2b2" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>std::uint64_t</type>
        <definition>std::uint64_t get_noc_addr</definition>
        <argsstring>(std::uint32_t noc_x, std::uint32_t noc_y, std::uint32_t addr)</argsstring>
        <name>get_noc_addr</name>
        <param>
          <type>std::uint32_t</type>
          <declname>noc_x</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>noc_y</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>addr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="484" column="15" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="484" bodyend="491"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aa850145f50aafa428c0d257cfed4fb8c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>std::uint64_t</type>
        <definition>std::uint64_t get_noc_addr_helper</definition>
        <argsstring>(std::uint32_t noc_xy, std::uint32_t addr)</argsstring>
        <name>get_noc_addr_helper</name>
        <param>
          <type>std::uint32_t</type>
          <declname>noc_xy</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>addr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="498" column="15" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="498" bodyend="504"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aba0d056dcf68dc0d8745c6eb6d6b36ef" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint64_t</type>
        <definition>uint64_t get_dram_noc_addr</definition>
        <argsstring>(const uint32_t id, const uint32_t page_size, const uint32_t bank_base_address, const uint32_t offset=0)</argsstring>
        <name>get_dram_noc_addr</name>
        <param>
          <type>const uint32_t</type>
          <declname>id</declname>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>page_size</declname>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>bank_base_address</declname>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>offset</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="508" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="508" bodyend="515"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aefcec950f39f40599c5c01a66d1055e1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint64_t</type>
        <definition>uint64_t get_l1_noc_addr</definition>
        <argsstring>(const uint32_t id, const uint32_t page_size, const uint32_t bank_base_address, const uint32_t offset=0)</argsstring>
        <name>get_l1_noc_addr</name>
        <param>
          <type>const uint32_t</type>
          <declname>id</declname>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>page_size</declname>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>bank_base_address</declname>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>offset</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="517" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="517" bodyend="524"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a6cea6159b23fc89dcfb5daa668439d1c" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint64_t</type>
        <definition>uint64_t get_system_memory_noc_addr</definition>
        <argsstring>(const uint32_t id, const uint32_t page_size, const uint32_t base_addr, const uint32_t offset=0)</argsstring>
        <name>get_system_memory_noc_addr</name>
        <param>
          <type>const uint32_t</type>
          <declname>id</declname>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>page_size</declname>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>base_addr</declname>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>offset</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="526" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="526" bodyend="531"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ab2336f9ac51bfd90b0393665f608785f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>std::uint64_t</type>
        <definition>std::uint64_t get_noc_addr</definition>
        <argsstring>(std::uint32_t addr)</argsstring>
        <name>get_noc_addr</name>
        <param>
          <type>std::uint32_t</type>
          <declname>addr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="534" column="15" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="534" bodyend="540"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ab97e89d297b36a2143d7f57011dd7ec5" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read</definition>
        <argsstring>(std::uint64_t src_noc_addr, std::uint32_t dst_local_l1_addr, std::uint32_t size)</argsstring>
        <name>noc_async_read</name>
        <param>
          <type>std::uint64_t</type>
          <declname>src_noc_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>dst_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Initiates an asynchronous read from a specified source node located at NOC coordinates (x,y) at a local address (encoded as a uint64_t using <emphasis>get_noc_addr</emphasis> function). The destination is in L1 memory on the Tensix core executing this function call. Also, see <emphasis>noc_async_read_barrier</emphasis>.</para>
<para>The source node can be either a DRAM bank, a Tensix core or a PCIe controller.</para>
<para>Return value: None</para>
<para><table rows="4" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Data type   </para>
</entry><entry thead="yes"><para>Valid range   </para>
</entry><entry thead="yes"><para>required    </para>
</entry></row>
<row>
<entry thead="no"><para>src_noc_addr   </para>
</entry><entry thead="no"><para>Encoding of the source NOC location (x,y)+address   </para>
</entry><entry thead="no"><para>uint64_t   </para>
</entry><entry thead="no"><para>DOX-TODO(ref to explain valid coords)   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para>dst_local_l1_addr   </para>
</entry><entry thead="no"><para>Address in local L1 memory   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>Yes    </para>
</entry></row>
<row>
<entry thead="no"><para>size   </para>
</entry><entry thead="no"><para>Size of data transfer in bytes   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>Yes   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="559" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="559" bodyend="568"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ad2263fe3188c0629cc6c40c30ad8dc27" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read_one_packet</definition>
        <argsstring>(std::uint64_t src_noc_addr, std::uint32_t dst_local_l1_addr, std::uint32_t size)</argsstring>
        <name>noc_async_read_one_packet</name>
        <param>
          <type>std::uint64_t</type>
          <declname>src_noc_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>dst_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="573" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="573" bodyend="598"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aa5dd39896c00012bcafdbff681f456be" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read_one_packet_set_state</definition>
        <argsstring>(std::uint64_t src_noc_addr, std::uint32_t size)</argsstring>
        <name>noc_async_read_one_packet_set_state</name>
        <param>
          <type>std::uint64_t</type>
          <declname>src_noc_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="603" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="603" bodyend="623"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1abf12fff178e5ec0115fcd9c503835bfe" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>inc_num_issued</declname>
            <defname>inc_num_issued</defname>
            <defval>true</defval>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void noc_async_read_one_packet_with_state</definition>
        <argsstring>(std::uint32_t src_noc_addr, std::uint32_t dst_local_l1_addr)</argsstring>
        <name>noc_async_read_one_packet_with_state</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_noc_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>dst_local_l1_addr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="629" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="629" bodyend="653"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1abc73bc75c5461bec168e308cc4dac463" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read_set_state</definition>
        <argsstring>(std::uint64_t src_noc_addr)</argsstring>
        <name>noc_async_read_set_state</name>
        <param>
          <type>std::uint64_t</type>
          <declname>src_noc_addr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="657" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="657" bodyend="675"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a5f0190364ed02bd2ebd4ad9dcaf66606" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>inc_num_issued</declname>
            <defname>inc_num_issued</defname>
            <defval>true</defval>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void noc_async_read_with_state</definition>
        <argsstring>(std::uint32_t src_noc_addr, std::uint32_t dst_local_l1_addr, std::uint32_t size)</argsstring>
        <name>noc_async_read_with_state</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_noc_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>dst_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="680" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="680" bodyend="721"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a4258a390cad1838db7970453230d3f20" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read_inc_num_issued</definition>
        <argsstring>(std::uint32_t num_issued_reads_inc)</argsstring>
        <name>noc_async_read_inc_num_issued</name>
        <param>
          <type>std::uint32_t</type>
          <declname>num_issued_reads_inc</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="724" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="724" bodyend="726"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ace2e10391566bc043956841d26c2b96a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_write_one_packet</definition>
        <argsstring>(std::uint32_t src_local_l1_addr, std::uint64_t dst_noc_addr, std::uint32_t size)</argsstring>
        <name>noc_async_write_one_packet</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint64_t</type>
          <declname>dst_noc_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="731" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="731" bodyend="755"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a243f72eb0de9e7694030ecabbdd55441" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_write_multicast_one_packet</definition>
        <argsstring>(std::uint32_t src_local_l1_addr, std::uint64_t dst_noc_addr_multicast, std::uint32_t size, std::uint32_t num_dests, bool linked=false, bool multicast_path_reserve=true)</argsstring>
        <name>noc_async_write_multicast_one_packet</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint64_t</type>
          <declname>dst_noc_addr_multicast</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>num_dests</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>linked</declname>
          <defval>false</defval>
        </param>
        <param>
          <type>bool</type>
          <declname>multicast_path_reserve</declname>
          <defval>true</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="760" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="760" bodyend="792"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a5e5d48b77f56a10bf3edba5d5907ea25" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>non_posted</declname>
            <defname>non_posted</defname>
            <defval>true</defval>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void noc_async_write_one_packet_set_state</definition>
        <argsstring>(std::uint64_t dst_noc_addr, std::uint32_t size)</argsstring>
        <name>noc_async_write_one_packet_set_state</name>
        <param>
          <type>std::uint64_t</type>
          <declname>dst_noc_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="798" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="798" bodyend="816"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a99bf42adaae3e6926445b84e7c30e20e" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>non_posted</declname>
            <defname>non_posted</defname>
            <defval>true</defval>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void noc_async_write_one_packet_with_state</definition>
        <argsstring>(std::uint32_t src_local_l1_addr, std::uint32_t dst_noc_addr)</argsstring>
        <name>noc_async_write_one_packet_with_state</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>dst_noc_addr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="822" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="822" bodyend="839"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aacf5989f91beb6b0ab26d115ac12fe6f" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>DRAM</declname>
            <defname>DRAM</defname>
          </param>
        </templateparamlist>
        <type>std::uint64_t</type>
        <definition>std::uint64_t get_noc_addr</definition>
        <argsstring>(const uint32_t id, const InterleavedAddrGen&lt; DRAM &gt; &amp;s, uint32_t offset=0)</argsstring>
        <name>get_noc_addr</name>
        <param>
          <type>const uint32_t</type>
          <declname>id</declname>
        </param>
        <param>
          <type>const <ref refid="structInterleavedAddrGen" kindref="compound">InterleavedAddrGen</ref>&lt; DRAM &gt; &amp;</type>
          <declname>s</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>offset</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1062" column="16" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1062" bodyend="1075"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a1ca192ad50dc46eabb2688cf1e0f0575" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>DRAM</declname>
            <defname>DRAM</defname>
          </param>
        </templateparamlist>
        <type>std::uint64_t</type>
        <definition>std::uint64_t get_noc_addr</definition>
        <argsstring>(const uint32_t id, const InterleavedPow2AddrGen&lt; DRAM &gt; &amp;s, uint32_t offset=0)</argsstring>
        <name>get_noc_addr</name>
        <param>
          <type>const uint32_t</type>
          <declname>id</declname>
        </param>
        <param>
          <type>const <ref refid="structInterleavedPow2AddrGen" kindref="compound">InterleavedPow2AddrGen</ref>&lt; DRAM &gt; &amp;</type>
          <declname>s</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>offset</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1078" column="16" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1078" bodyend="1091"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aee5ebbce5f15ef2a4999f983a7d13fe0" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>DRAM</declname>
            <defname>DRAM</defname>
          </param>
        </templateparamlist>
        <type>std::uint64_t</type>
        <definition>std::uint64_t get_noc_addr</definition>
        <argsstring>(const uint32_t id, const InterleavedAddrGenFast&lt; DRAM &gt; &amp;s, uint32_t offset=0)</argsstring>
        <name>get_noc_addr</name>
        <param>
          <type>const uint32_t</type>
          <declname>id</declname>
        </param>
        <param>
          <type>const <ref refid="structInterleavedAddrGenFast" kindref="compound">InterleavedAddrGenFast</ref>&lt; DRAM &gt; &amp;</type>
          <declname>s</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>offset</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1094" column="16" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1094" bodyend="1107"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aa628194296041838dd0512194f78cb4b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>DRAM</declname>
            <defname>DRAM</defname>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void noc_async_read_page</definition>
        <argsstring>(const uint32_t id, const InterleavedAddrGen&lt; DRAM &gt; &amp;s, std::uint32_t dst_local_l1_addr, uint32_t offset=0)</argsstring>
        <name>noc_async_read_page</name>
        <param>
          <type>const uint32_t</type>
          <declname>id</declname>
        </param>
        <param>
          <type>const <ref refid="structInterleavedAddrGen" kindref="compound">InterleavedAddrGen</ref>&lt; DRAM &gt; &amp;</type>
          <declname>s</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>dst_local_l1_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>offset</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1110" column="7" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1110" bodyend="1117"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ab74a8d9d97b2e7d1c15454db2c7d7431" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>DRAM</declname>
            <defname>DRAM</defname>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void noc_async_read_tile</definition>
        <argsstring>(const uint32_t id, const InterleavedAddrGenFast&lt; DRAM &gt; &amp;s, std::uint32_t dst_local_l1_addr, uint32_t offset=0)</argsstring>
        <name>noc_async_read_tile</name>
        <param>
          <type>const uint32_t</type>
          <declname>id</declname>
        </param>
        <param>
          <type>const <ref refid="structInterleavedAddrGenFast" kindref="compound">InterleavedAddrGenFast</ref>&lt; DRAM &gt; &amp;</type>
          <declname>s</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>dst_local_l1_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>offset</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1120" column="7" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1120" bodyend="1127"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ae5353d488f5a68e6eb89fae5ea1be951" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>uint32_t</type>
            <declname>max_page_size</declname>
            <defname>max_page_size</defname>
            <defval>NOC_MAX_BURST_SIZE + 1</defval>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void noc_async_write</definition>
        <argsstring>(std::uint32_t src_local_l1_addr, std::uint64_t dst_noc_addr, std::uint32_t size)</argsstring>
        <name>noc_async_write</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint64_t</type>
          <declname>dst_noc_addr</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Initiates an asynchronous write from a source address in L1 memory on the Tensix core executing this function call. The destination is specified using a uint64_t encoding referencing an on-chip node located at NOC coordinates (x,y) and a local address created using get_noc_addr function. Also, see <emphasis>noc_async_write_barrier</emphasis>.</para>
<para>The destination node can be either a DRAM bank, Tensix core+L1 memory address or a PCIe controller.</para>
<para>Return value: None</para>
<para><table rows="4" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>src_local_l1_addr   </para>
</entry><entry thead="no"><para>Source address in local L1 memory   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>dst_noc_addr   </para>
</entry><entry thead="no"><para>Encoding of the destination NOC location (x,y)+address   </para>
</entry><entry thead="no"><para>uint64_t   </para>
</entry><entry thead="no"><para>DOX-TODO(insert a reference to what constitutes valid coords)   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>size   </para>
</entry><entry thead="no"><para>Size of data transfer in bytes   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1149" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1149" bodyend="1168"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1afa1c9f72ce143d24b995167a49eff5e4" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>bool</type>
            <declname>DRAM</declname>
            <defname>DRAM</defname>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void noc_async_write_tile</definition>
        <argsstring>(const uint32_t id, const InterleavedAddrGenFast&lt; DRAM &gt; &amp;s, std::uint32_t src_local_l1_addr)</argsstring>
        <name>noc_async_write_tile</name>
        <param>
          <type>const uint32_t</type>
          <declname>id</declname>
        </param>
        <param>
          <type>const <ref refid="structInterleavedAddrGenFast" kindref="compound">InterleavedAddrGenFast</ref>&lt; DRAM &gt; &amp;</type>
          <declname>s</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1171" column="7" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1171" bodyend="1174"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aad24ffd7fc05b797ce38e6072c2f0eab" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>ProgrammableCoreType</type>
            <declname>type</declname>
            <defname>type</defname>
            <defval>ProgrammableCoreType::TENSIX</defval>
          </param>
        </templateparamlist>
        <type>uint32_t</type>
        <definition>uint32_t get_semaphore</definition>
        <argsstring>(uint32_t semaphore_id)</argsstring>
        <name>get_semaphore</name>
        <param>
          <type>uint32_t</type>
          <declname>semaphore_id</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1178" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1178" bodyend="1180"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aff57d6bb75c161882cd3751a3f4a67ba" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>void noc_semaphore_set_remote</definition>
        <argsstring>(std::uint32_t src_local_l1_addr, std::uint64_t dst_noc_addr)</argsstring>
        <name>noc_semaphore_set_remote</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint64_t</type>
          <declname>dst_noc_addr</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1183" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1183" bodyend="1198"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1aebb548dd7fb5654248c32b147531c8d2" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>uint32_t</type>
            <declname>max_page_size</declname>
            <defname>max_page_size</defname>
            <defval>NOC_MAX_BURST_SIZE + 1</defval>
          </param>
        </templateparamlist>
        <type>void</type>
        <definition>void noc_async_write_multicast</definition>
        <argsstring>(std::uint32_t src_local_l1_addr, std::uint64_t dst_noc_addr_multicast, std::uint32_t size, std::uint32_t num_dests, bool linked=false, bool multicast_path_reserve=true)</argsstring>
        <name>noc_async_write_multicast</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint64_t</type>
          <declname>dst_noc_addr_multicast</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>num_dests</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>linked</declname>
          <defval>false</defval>
        </param>
        <param>
          <type>bool</type>
          <declname>multicast_path_reserve</declname>
          <defval>true</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Initiates an asynchronous write from a source address in L1 memory on the Tensix core executing this function call to a rectangular destination grid. The destinations are specified using a uint64_t encoding referencing an on-chip grid of nodes located at NOC coordinate range (x_start,y_start,x_end,y_end) and a local address created using <emphasis>get_noc_multicast_addr</emphasis> function. Also, <emphasis>see noc_async_write_barrier</emphasis>.</para>
<para>The destination nodes can only be a set of Tensix cores + L1 memory address. The destination nodes must form a rectangular grid. The destination L1 memory address must be the same on all destination nodes.</para>
<para>With this API, the multicast sender cannot be part of the multicast destinations. If the multicast sender has to be in the multicast destinations (i.e. must perform a local L1 write), the other API variant <emphasis>noc_async_write_multicast_loopback_src</emphasis> can be used.</para>
<para>Note: The number of destinations needs to be non-zero. Besides that, there is no restriction on the number of destinations, i.e. the multicast destinations can span the full chip. However, as mentioned previously, the multicast source cannot be part of the destinations. So, the maximum number of destinations is 119.</para>
<para>Return value: None</para>
<para><table rows="5" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>src_local_l1_addr   </para>
</entry><entry thead="no"><para>Source address in local L1 memory   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>dst_noc_addr_multicast   </para>
</entry><entry thead="no"><para>Encoding of the destinations nodes (x_start,y_start,x_end,y_end)+address   </para>
</entry><entry thead="no"><para>uint64_t   </para>
</entry><entry thead="no"><para>DOX-TODO(insert a reference to what constitutes valid coords)   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>size   </para>
</entry><entry thead="no"><para>Size of data transfer in bytes   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>num_dests   </para>
</entry><entry thead="no"><para>Number of destinations that the multicast source is targetting   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..119   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1234" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1234" bodyend="1259"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1af1debd77eb9592540a899290fb2a1709" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>void noc_semaphore_set_multicast</definition>
        <argsstring>(std::uint32_t src_local_l1_addr, std::uint64_t dst_noc_addr_multicast, std::uint32_t num_dests, bool linked=false, bool multicast_path_reserve=true)</argsstring>
        <name>noc_semaphore_set_multicast</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint64_t</type>
          <declname>dst_noc_addr_multicast</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>num_dests</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>linked</declname>
          <defval>false</defval>
        </param>
        <param>
          <type>bool</type>
          <declname>multicast_path_reserve</declname>
          <defval>true</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Initiates an asynchronous write from a source address in L1 memory on the Tensix core executing this function call to a rectangular destination grid. The destinations are specified using a uint64_t encoding referencing an on-chip grid of nodes located at NOC coordinate range (x_start,y_start,x_end,y_end) and a local address created using <emphasis>get_noc_multicast_addr</emphasis> function. The size of data that is sent is 4 Bytes. This is usually used to set a semaphore value at the destination nodes, as a way of a synchronization mechanism. The same as <emphasis>noc_async_write_multicast</emphasis> with preset size of 4 Bytes.</para>
<para>With this API, the multicast sender cannot be part of the multicast destinations. If the multicast sender has to be in the multicast destinations (i.e. must perform a local L1 write), the other API variant <emphasis>noc_semaphore_set_multicast_loopback_src</emphasis> can be used.</para>
<para>Return value: None</para>
<para><table rows="4" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>src_local_l1_addr   </para>
</entry><entry thead="no"><para>Source address in local L1 memory   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>dst_noc_addr_multicast   </para>
</entry><entry thead="no"><para>Encoding of the destinations nodes (x_start,y_start,x_end,y_end)+address   </para>
</entry><entry thead="no"><para>uint64_t   </para>
</entry><entry thead="no"><para>DOX-TODO(insert a reference to what constitutes valid coords)   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>num_dests   </para>
</entry><entry thead="no"><para>Number of destinations that the multicast source is targetting   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..119   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1286" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1286" bodyend="1302"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ab629fc4e0e17a8ed09e5a6b264927b18" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>void noc_semaphore_set_multicast_loopback_src</definition>
        <argsstring>(std::uint32_t src_local_l1_addr, std::uint64_t dst_noc_addr_multicast, std::uint32_t num_dests, bool linked=false, bool multicast_path_reserve=true)</argsstring>
        <name>noc_semaphore_set_multicast_loopback_src</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint64_t</type>
          <declname>dst_noc_addr_multicast</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>num_dests</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>linked</declname>
          <defval>false</defval>
        </param>
        <param>
          <type>bool</type>
          <declname>multicast_path_reserve</declname>
          <defval>true</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Initiates an asynchronous write from a source address in L1 memory on the Tensix core executing this function call to a rectangular destination grid. The destinations are specified using a uint64_t encoding referencing an on-chip grid of nodes located at NOC coordinate range (x_start,y_start,x_end,y_end) and a local address created using <emphasis>get_noc_multicast_addr</emphasis> function. The size of data that is sent is 4 Bytes. This is usually used to set a semaphore value at the destination nodes, as a way of a synchronization mechanism. The same as <emphasis>noc_async_write_multicast</emphasis> with preset size of 4 Bytes.</para>
<para>Note: With this API, sending data only to the source node (when num_dests is 1) may result in unexpected behaviour. For some parameters, hangs have been observed. For some other parameters, nothing may happen. Consider using regular non multicast operations such as <emphasis>noc_async_write</emphasis> in this case.</para>
<para>Return value: None</para>
<para><table rows="4" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>src_local_l1_addr   </para>
</entry><entry thead="no"><para>Source address in local L1 memory   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>dst_noc_addr_multicast   </para>
</entry><entry thead="no"><para>Encoding of the destinations nodes (x_start,y_start,x_end,y_end)+address   </para>
</entry><entry thead="no"><para>uint64_t   </para>
</entry><entry thead="no"><para>DOX-TODO(insert a reference to what constitutes valid coords)   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>num_dests   </para>
</entry><entry thead="no"><para>Number of destinations that the multicast source is targetting   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..119   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1328" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1328" bodyend="1344"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a4ac57ae59ef98d40b2081b80e5636d20" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_write_multicast_loopback_src</definition>
        <argsstring>(std::uint32_t src_local_l1_addr, std::uint64_t dst_noc_addr_multicast, std::uint32_t size, std::uint32_t num_dests, bool linked=false, bool multicast_path_reserve=true)</argsstring>
        <name>noc_async_write_multicast_loopback_src</name>
        <param>
          <type>std::uint32_t</type>
          <declname>src_local_l1_addr</declname>
        </param>
        <param>
          <type>std::uint64_t</type>
          <declname>dst_noc_addr_multicast</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>size</declname>
        </param>
        <param>
          <type>std::uint32_t</type>
          <declname>num_dests</declname>
        </param>
        <param>
          <type>bool</type>
          <declname>linked</declname>
          <defval>false</defval>
        </param>
        <param>
          <type>bool</type>
          <declname>multicast_path_reserve</declname>
          <defval>true</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1347" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1347" bodyend="1368"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a8da61f7d36de3d865b04acf3656c7950" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read_barrier</definition>
        <argsstring>()</argsstring>
        <name>noc_async_read_barrier</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>This blocking call waits for all the outstanding enqueued <emphasis>noc_async_read</emphasis> calls issued on the current Tensix core to complete. After returning from this call the <emphasis>noc_async_read</emphasis> queue will be empty for the current Tensix core.</para>
<para>Return value: None </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1379" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1379" bodyend="1386"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a8a1af3e9115ddcd9d2e4b0c8b4a4b680" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_write_barrier</definition>
        <argsstring>()</argsstring>
        <name>noc_async_write_barrier</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>This blocking call waits for all the outstanding enqueued <emphasis>noc_async_write</emphasis> calls issued on the current Tensix core to complete. After returning from this call the <emphasis>noc_async_write</emphasis> queue will be empty for the current Tensix core.</para>
<para>Return value: None </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1397" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1397" bodyend="1402"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a82c38db0fda2eaafccd0aac9635f0dc1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_writes_flushed</definition>
        <argsstring>()</argsstring>
        <name>noc_async_writes_flushed</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>This blocking call waits for all outstanding enqueued <emphasis>noc_async_write</emphasis> calls issued on the current Tensix core to depart, but will not wait for them to complete </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1410" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1410" bodyend="1415"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a13a74d46d62931d19a406414db103c4b" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_atomic_barrier</definition>
        <argsstring>(uint8_t noc_idx=noc_index)</argsstring>
        <name>noc_async_atomic_barrier</name>
        <param>
          <type>uint8_t</type>
          <declname>noc_idx</declname>
          <defval>noc_index</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>This blocking call waits for all the outstanding enqueued <emphasis>noc_async_write</emphasis> calls issued on the current Tensix core to complete. After returning from this call the <emphasis>noc_async_write</emphasis> queue will be empty for the current Tensix core.</para>
<para>Return value: None </para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1426" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1426" bodyend="1431"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a4f714cc4a08a2eaac5e3f7fae9d1383a" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_semaphore_wait</definition>
        <argsstring>(volatile uint32_t *sem_addr, uint32_t val)</argsstring>
        <name>noc_semaphore_wait</name>
        <param>
          <type>volatile uint32_t *</type>
          <declname>sem_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>val</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>A blocking call that waits until the value of a local L1 memory address on the Tensix core executing this function becomes equal to a target value. This L1 memory address is used as a semaphore of size 4 Bytes, as a synchronization mechanism. Also, see <emphasis>noc_semaphore_set</emphasis>.</para>
<para>Return value: None</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>sem_addr   </para>
</entry><entry thead="no"><para>Semaphore address in local L1 memory   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>val   </para>
</entry><entry thead="no"><para>The target value of the semaphore   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>Any uint32_t value   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1447" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1447" bodyend="1453"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a84a965a61b65152c42835f35dca007af" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_semaphore_wait_min</definition>
        <argsstring>(volatile uint32_t *sem_addr, uint32_t val)</argsstring>
        <name>noc_semaphore_wait_min</name>
        <param>
          <type>volatile uint32_t *</type>
          <declname>sem_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>val</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>A blocking call that waits until the value of a local L1 memory address on the Tensix core executing this function becomes equal or greater than a target value. This L1 memory address is used as a semaphore of size 4 Bytes, as a synchronization mechanism. Also, see <emphasis>noc_semaphore_set</emphasis>.</para>
<para>Return value: None</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>sem_addr   </para>
</entry><entry thead="no"><para>Semaphore address in local L1 memory   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>val   </para>
</entry><entry thead="no"><para>The target value of the semaphore   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>Any uint32_t value   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1469" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1469" bodyend="1475"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1af02a9af640679b00da874318535aa397" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_semaphore_set</definition>
        <argsstring>(volatile uint32_t *sem_addr, uint32_t val)</argsstring>
        <name>noc_semaphore_set</name>
        <param>
          <type>volatile uint32_t *</type>
          <declname>sem_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>val</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Sets the value of a local L1 memory address on the Tensix core executing this function to a specific value. This L1 memory address is used as a semaphore of size 4 Bytes, as a synchronization mechanism. Also, see <emphasis>noc_semaphore_wait</emphasis>.</para>
<para>Return value: None</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>sem_addr   </para>
</entry><entry thead="no"><para>Semaphore address in local L1 memory   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>0..1MB   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>val   </para>
</entry><entry thead="no"><para>Value to set the semaphore to   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>Any uint32_t value   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1491" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1491" bodyend="1494"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a1f11981622b01c9e42d44a939ec30be1" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_inline_dw_write</definition>
        <argsstring>(uint64_t addr, uint32_t val, uint8_t be=0xF)</argsstring>
        <name>noc_inline_dw_write</name>
        <param>
          <type>uint64_t</type>
          <declname>addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>val</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>be</declname>
          <defval>0xF</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>Initiates an asynchronous write of a 32-bit value to a NOC destination. Typically used for writing registers, but can be used for memory locations as well. The destination is specified as a 64-bit NOC address (see <emphasis>noc_async_write</emphasis>). The advantage over using <emphasis>noc_async_write</emphasis> is that we don&apos;t a Tensix L1 memory source location; the write value is written directly into a register. Unlike using <emphasis>noc_async_write</emphasis>, there are also no address alignment concerns. Also, see <emphasis>noc_async_write_barrier</emphasis>.</para>
<para>The destination node can be either a DRAM bank, Tensix core+L1 memory address or a PCIe controller.</para>
<para>Return value: None</para>
<para><table rows="4" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>addr   </para>
</entry><entry thead="no"><para>Encoding of the destination location (x,y)+address   </para>
</entry><entry thead="no"><para>uint64_t   </para>
</entry><entry thead="no"><para>DOX-TODO(insert a reference to what constitutes valid coords)   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>val   </para>
</entry><entry thead="no"><para>The value to be written   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>Any uint32_t value   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>be   </para>
</entry><entry thead="no"><para>Byte-enable   </para>
</entry><entry thead="no"><para>uint8_t   </para>
</entry><entry thead="no"><para>0x1-0xF   </para>
</entry><entry thead="no"><para>False   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1518" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1518" bodyend="1533"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a962d804ce21d1d26ccb4241e2eb6ac9f" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>void noc_semaphore_inc</definition>
        <argsstring>(uint64_t addr, uint32_t incr, uint8_t noc_id=noc_index)</argsstring>
        <name>noc_semaphore_inc</name>
        <param>
          <type>uint64_t</type>
          <declname>addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>incr</declname>
        </param>
        <param>
          <type>uint8_t</type>
          <declname>noc_id</declname>
          <defval>noc_index</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
<para>The Tensix core executing this function call initiates an atomic increment (with 32-bit wrap) of a remote Tensix core L1 memory address. This L1 memory address is used as a semaphore of size 4 Bytes, as a synchronization mechanism.</para>
<para>Return value: None</para>
<para><table rows="3" cols="5"><row>
<entry thead="yes"><para>Argument   </para>
</entry><entry thead="yes"><para>Description   </para>
</entry><entry thead="yes"><para>Type   </para>
</entry><entry thead="yes"><para>Valid Range   </para>
</entry><entry thead="yes"><para>Required    </para>
</entry></row>
<row>
<entry thead="no"><para>addr   </para>
</entry><entry thead="no"><para>Encoding of the destination location (x,y)+address   </para>
</entry><entry thead="no"><para>uint64_t   </para>
</entry><entry thead="no"><para>DOX-TODO(insert a reference to what constitutes valid coords)   </para>
</entry><entry thead="no"><para>True    </para>
</entry></row>
<row>
<entry thead="no"><para>incr   </para>
</entry><entry thead="no"><para>The value to increment by   </para>
</entry><entry thead="no"><para>uint32_t   </para>
</entry><entry thead="no"><para>Any uint32_t value   </para>
</entry><entry thead="no"><para>True   </para>
</entry></row>
</table>
</para>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1551" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1551" bodyend="1561"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a9e9618b5b64ed1ae0d0a747ac0f10745" prot="public" static="no" const="no" explicit="no" inline="yes" virt="non-virtual">
        <type>void</type>
        <definition>void RISC_POST_HEARTBEAT</definition>
        <argsstring>(uint32_t &amp;heartbeat)</argsstring>
        <name>RISC_POST_HEARTBEAT</name>
        <param>
          <type>uint32_t &amp;</type>
          <declname>heartbeat</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1563" column="13" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1563" bodyend="1568"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a29bd290aaee1b41529717b029dc14952" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>uint32_t</type>
        <definition>uint32_t min</definition>
        <argsstring>(uint32_t a, uint32_t b)</argsstring>
        <name>min</name>
        <param>
          <type>uint32_t</type>
          <declname>a</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>b</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1571" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1571" bodyend="1571"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a0de16ed70bc7231b31eb861b6d0a6842" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <templateparamlist>
          <param>
            <type>uint32_t</type>
            <declname>page_size</declname>
            <defname>page_size</defname>
          </param>
          <param>
            <type>bool</type>
            <declname>use_vc</declname>
            <defname>use_vc</defname>
          </param>
        </templateparamlist>
        <type>uint32_t</type>
        <definition>uint32_t noc_async_read_tile_dram_sharded_set_state</definition>
        <argsstring>(uint32_t bank_base_address, uint32_t bank_id=0, const uint32_t vc=0)</argsstring>
        <name>noc_async_read_tile_dram_sharded_set_state</name>
        <param>
          <type>uint32_t</type>
          <declname>bank_base_address</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>bank_id</declname>
          <defval>0</defval>
        </param>
        <param>
          <type>const uint32_t</type>
          <declname>vc</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1575" column="10" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1575" bodyend="1595"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a907a8339412ff90e99743a4ca71af910" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read_tile_dram_sharded_with_state</definition>
        <argsstring>(uint32_t src_base_addr, uint32_t src_addr, uint32_t dest_addr, uint32_t trid=0)</argsstring>
        <name>noc_async_read_tile_dram_sharded_with_state</name>
        <param>
          <type>uint32_t</type>
          <declname>src_base_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>src_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>dest_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>trid</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1598" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1598" bodyend="1611"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1ae92c034dfaaa6b841194aab8e7d5ec42" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read_tile_dram_sharded_with_state_with_trid</definition>
        <argsstring>(uint32_t src_base_addr, uint32_t src_addr, uint32_t dest_addr, uint32_t trid=0)</argsstring>
        <name>noc_async_read_tile_dram_sharded_with_state_with_trid</name>
        <param>
          <type>uint32_t</type>
          <declname>src_base_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>src_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>dest_addr</declname>
        </param>
        <param>
          <type>uint32_t</type>
          <declname>trid</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1614" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1614" bodyend="1620"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a799ce34e86a34e05f3dd8f30cf958378" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read_tile_dram_sharded_set_trid</definition>
        <argsstring>(uint32_t trid=0)</argsstring>
        <name>noc_async_read_tile_dram_sharded_set_trid</name>
        <param>
          <type>uint32_t</type>
          <declname>trid</declname>
          <defval>0</defval>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1623" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1623" bodyend="1629"/>
      </memberdef>
      <memberdef kind="function" id="dataflow__api_8h_1a5515ebbed8b273697e2f44894cf3be28" prot="public" static="no" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>void</type>
        <definition>void noc_async_read_barrier_with_trid</definition>
        <argsstring>(uint32_t trid)</argsstring>
        <name>noc_async_read_barrier_with_trid</name>
        <param>
          <type>uint32_t</type>
          <declname>trid</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="tt_metal/hw/inc/dataflow_api.h" line="1632" column="6" bodyfile="tt_metal/hw/inc/dataflow_api.h" bodystart="1632" bodyend="1640"/>
      </memberdef>
      </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="comment">//<sp/>SPDX-FileCopyrightText:<sp/>©<sp/>2023<sp/>Tenstorrent<sp/>Inc.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3"><highlight class="normal"></highlight><highlight class="comment">//<sp/>SPDX-License-Identifier:<sp/>Apache-2.0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4"><highlight class="normal"></highlight></codeline>
<codeline lineno="5"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>once</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6"><highlight class="normal"></highlight></codeline>
<codeline lineno="7"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>__has_include(&quot;chlkc_unpack_data_format.h&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;chlkc_pack_data_format.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;chlkc_unpack_data_format.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>DATA_FORMATS_DEFINED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="12"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>__has_include(&quot;generated_bank_to_noc_coord_mapping.h&quot;</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="13"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;generated_bank_to_noc_coord_mapping.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="14"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="15"><highlight class="normal"></highlight></codeline>
<codeline lineno="16"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&lt;stdint.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="17"><highlight class="normal"></highlight></codeline>
<codeline lineno="18"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;core_config.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="19"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;circular_buffer.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="20"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;debug/sanitize_noc.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="21"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;debug/waypoint.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="22"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;eth_l1_address_map.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="23"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hostdevcommon/common_runtime_address_map.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="24"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;hostdevcommon/common_values.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="25"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;risc_attribs.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="26"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;third_party/umd/device/tt_silicon_driver_common.hpp&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="27"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;debug/assert.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="28"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;dev_msgs.h&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="29"><highlight class="normal"></highlight></codeline>
<codeline lineno="30"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/>uint8_t<sp/>noc_index;</highlight></codeline>
<codeline lineno="31"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/>uint32_t<sp/>tt_l1_ptr<sp/>*rta_l1_base;</highlight></codeline>
<codeline lineno="32"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/>uint32_t<sp/>tt_l1_ptr<sp/>*crta_l1_base;</highlight></codeline>
<codeline lineno="33"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/>uint32_t<sp/>tt_l1_ptr<sp/>*sem_l1_base[];</highlight></codeline>
<codeline lineno="34"><highlight class="normal"></highlight></codeline>
<codeline lineno="40"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/>CBInterface<sp/>cb_interface[NUM_CIRCULAR_BUFFERS];</highlight></codeline>
<codeline lineno="41"><highlight class="normal"></highlight></codeline>
<codeline lineno="42"><highlight class="normal"></highlight><highlight class="comment">//<sp/>Use<sp/>VC<sp/>1<sp/>for<sp/>unicast<sp/>writes,<sp/>and<sp/>VC<sp/>4<sp/>for<sp/>mcast<sp/>writes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="43"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NOC_UNICAST_WRITE_VC<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="44"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NOC_MULTICAST_WRITE_VC<sp/>4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="45"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>NOC_DISPATCH_MULTICAST_WRITE_VC<sp/>5<sp/></highlight><highlight class="comment">//<sp/>Only<sp/>to<sp/>be<sp/>used<sp/>by<sp/>the<sp/>dispatch<sp/>cores</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="46"><highlight class="normal"></highlight></codeline>
<codeline lineno="47"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="48"><highlight class="normal">uint32_t<sp/>align(uint32_t<sp/>addr,<sp/>uint32_t<sp/>alignment)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((addr<sp/>-<sp/>1)<sp/>|<sp/>(alignment<sp/>-<sp/>1))<sp/>+<sp/>1;<sp/>}</highlight></codeline>
<codeline lineno="49"><highlight class="normal"></highlight></codeline>
<codeline lineno="50"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">interleaved_addr_gen<sp/>{</highlight></codeline>
<codeline lineno="51"><highlight class="normal"></highlight></codeline>
<codeline lineno="52"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="53"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="54"><highlight class="normal">uint32_t<sp/>get_bank_offset_index(uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="55"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(DRAM)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>DRAM</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="56"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>IS_NOT_POW2_NUM_DRAM_BANKS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="57"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>udivsi3_const_divisor&lt;NUM_DRAM_BANKS&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="58"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="59"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>&gt;&gt;<sp/>LOG_BASE_2_OF_NUM_DRAM_BANKS;</highlight></codeline>
<codeline lineno="60"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="61"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>L1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="62"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>IS_NOT_POW2_NUM_L1_BANKS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>udivsi3_const_divisor&lt;NUM_L1_BANKS&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="64"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>&gt;&gt;<sp/>LOG_BASE_2_OF_NUM_L1_BANKS;</highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="68"><highlight class="normal">}</highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="71"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="72"><highlight class="normal">uint32_t<sp/>get_bank_index(uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>uint32_t<sp/>bank_offset_index)<sp/>{</highlight></codeline>
<codeline lineno="73"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(DRAM)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>DRAM</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>IS_NOT_POW2_NUM_DRAM_BANKS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>-<sp/>bank_offset_index<sp/>*<sp/>NUM_DRAM_BANKS;</highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>&amp;<sp/>(NUM_DRAM_BANKS<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>L1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>IS_NOT_POW2_NUM_L1_BANKS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>-<sp/>bank_offset_index<sp/>*<sp/>NUM_L1_BANKS;</highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>&amp;<sp/>(NUM_L1_BANKS<sp/>-<sp/>1);</highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="86"><highlight class="normal">}</highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="89"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="90"><highlight class="normal">uint32_t<sp/>get_noc_xy(uint32_t<sp/>bank_index)<sp/>{</highlight></codeline>
<codeline lineno="91"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(DRAM)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>DRAM</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="92"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>dram_bank_to_noc_xy[noc_index][bank_index];</highlight></codeline>
<codeline lineno="93"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>L1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="94"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>l1_bank_to_noc_xy[noc_index][bank_index];</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="97"><highlight class="normal">}</highlight></codeline>
<codeline lineno="98"><highlight class="normal"></highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="100"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="101"><highlight class="normal">uint32_t<sp/>get_bank_offset(uint32_t<sp/>bank_index)<sp/>{</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(DRAM)<sp/>{<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>DRAM</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bank_to_dram_offset[bank_index];</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>L1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>bank_to_l1_offset[bank_index];</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="108"><highlight class="normal">}</highlight></codeline>
<codeline lineno="109"><highlight class="normal"></highlight></codeline>
<codeline lineno="110"><highlight class="normal">}<sp/><sp/></highlight><highlight class="comment">//<sp/>namespace<sp/>addrgen</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111"><highlight class="normal"></highlight></codeline>
<codeline lineno="112"><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="123"><highlight class="normal">uint32_t<sp/>get_arg_addr(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arg_idx)<sp/>{</highlight></codeline>
<codeline lineno="124"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(uint32_t)&amp;rta_l1_base[arg_idx];;</highlight></codeline>
<codeline lineno="125"><highlight class="normal">}</highlight></codeline>
<codeline lineno="126"><highlight class="normal"></highlight></codeline>
<codeline lineno="136"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="137"><highlight class="normal">uint32_t<sp/>get_common_arg_addr(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arg_idx)<sp/>{</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(uint32_t)&amp;crta_l1_base[arg_idx];</highlight></codeline>
<codeline lineno="139"><highlight class="normal">}</highlight></codeline>
<codeline lineno="140"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="152" refid="dataflow__api_8h_1a6a5074e8cd2732fcecab57fced3ebd1f" refkind="member"><highlight class="normal">FORCE_INLINE<sp/>T<sp/><ref refid="dataflow__api_8h_1a6a5074e8cd2732fcecab57fced3ebd1f" kindref="member">get_arg_val</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arg_idx)<sp/>{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>only<sp/>4B<sp/>args<sp/>are<sp/>supported<sp/>(eg<sp/>int32,<sp/>uint32)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static_assert</highlight><highlight class="normal">(</highlight><highlight class="stringliteral">&quot;Error:<sp/>only<sp/>4B<sp/>args<sp/>are<sp/>supported&quot;</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T)<sp/>==<sp/>4);</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*((tt_l1_ptr<sp/>T*)(get_arg_addr(arg_idx)));</highlight></codeline>
<codeline lineno="156"><highlight class="normal">}</highlight></codeline>
<codeline lineno="157"><highlight class="normal"></highlight></codeline>
<codeline lineno="168"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keyword">typename</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="169" refid="dataflow__api_8h_1abba486e3732fb5ea715651f92234e60a" refkind="member"><highlight class="normal">FORCE_INLINE<sp/>T<sp/><ref refid="dataflow__api_8h_1abba486e3732fb5ea715651f92234e60a" kindref="member">get_common_arg_val</ref>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>arg_idx)<sp/>{</highlight></codeline>
<codeline lineno="170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>only<sp/>4B<sp/>args<sp/>are<sp/>supported<sp/>(eg<sp/>int32,<sp/>uint32)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">static_assert</highlight><highlight class="normal">(</highlight><highlight class="stringliteral">&quot;Error:<sp/>only<sp/>4B<sp/>args<sp/>are<sp/>supported&quot;</highlight><highlight class="normal"><sp/>&amp;&amp;<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T)<sp/>==<sp/>4);</highlight></codeline>
<codeline lineno="172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>*((</highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>tt_l1_ptr<sp/>T*)(get_common_arg_addr(arg_idx)));</highlight></codeline>
<codeline lineno="173"><highlight class="normal">}</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"></highlight></codeline>
<codeline lineno="186" refid="dataflow__api_8h_1ab97f9dbfbb4150cb324f21520b8e6cfe" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>get_compile_time_arg_val(arg_idx)<sp/>KERNEL_COMPILE_TIME_ARG_##arg_idx</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="187"><highlight class="normal"></highlight></codeline>
<codeline lineno="188"><highlight class="normal"></highlight></codeline>
<codeline lineno="189"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>std::int32_t<sp/>GET_TILE_SIZE(uint<sp/>format)<sp/>{</highlight></codeline>
<codeline lineno="191"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(format<sp/>&amp;<sp/>0x1F)<sp/>{</highlight></codeline>
<codeline lineno="192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Float16_b):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((2048));</highlight></codeline>
<codeline lineno="193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Float16):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((2048));</highlight></codeline>
<codeline lineno="194"><highlight class="normal"></highlight></codeline>
<codeline lineno="195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::UInt8):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((1024));</highlight></codeline>
<codeline lineno="196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::UInt16):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((2048));</highlight></codeline>
<codeline lineno="197"><highlight class="normal"></highlight></codeline>
<codeline lineno="198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp8):</highlight></codeline>
<codeline lineno="199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp8_b):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((1024)<sp/>+<sp/>(64));</highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight></codeline>
<codeline lineno="201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Int32):</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::UInt32):</highlight></codeline>
<codeline lineno="203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Float32):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((4096));</highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp4):</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp4_b):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((512)<sp/>+<sp/>(64));</highlight></codeline>
<codeline lineno="207"><highlight class="normal"></highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp2):</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp2_b):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((256)<sp/>+<sp/>(64));</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((1024)<sp/>+<sp/>(64));</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="212"><highlight class="normal">}</highlight></codeline>
<codeline lineno="213"><highlight class="normal"></highlight></codeline>
<codeline lineno="214"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="215"><highlight class="normal"></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>std::uint32_t<sp/>MUL_WITH_TILE_SIZE(uint<sp/>format,<sp/>uint<sp/>index)<sp/>{</highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(format<sp/>&amp;<sp/>0x1F)<sp/>{</highlight></codeline>
<codeline lineno="217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::UInt8):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(index<sp/>&lt;&lt;<sp/>10);</highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::UInt16):</highlight></codeline>
<codeline lineno="219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Float16):</highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Float16_b):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(index<sp/>&lt;&lt;<sp/>11);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Int32):</highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::UInt32):</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Float32):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(index<sp/>&lt;&lt;<sp/>12);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp2):</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp2_b):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((index<sp/>&lt;&lt;<sp/>8)<sp/>+<sp/>(index<sp/>&lt;&lt;<sp/>6));</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp4):</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp4_b):<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((index<sp/>&lt;&lt;<sp/>9)<sp/>+<sp/>(index<sp/>&lt;&lt;<sp/>6));</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp8):</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>((uint8_t)DataFormat::Bfp8_b):</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Keep<sp/>default<sp/>as<sp/>Bfp8?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((index<sp/>&lt;&lt;<sp/>10)<sp/>+<sp/>(index<sp/>&lt;&lt;<sp/>6));</highlight></codeline>
<codeline lineno="232"><highlight class="normal"><sp/><sp/><sp/><sp/>};</highlight></codeline>
<codeline lineno="233"><highlight class="normal">}</highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight></codeline>
<codeline lineno="257"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="258" refid="dataflow__api_8h_1a81357224b88562601b42833eec676ffb" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a81357224b88562601b42833eec676ffb" kindref="member">cb_push_back</ref>(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int32_t<sp/>operand,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>int32_t<sp/>num_pages)<sp/>{</highlight></codeline>
<codeline lineno="259"><highlight class="normal"></highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>num_words<sp/>=<sp/>num_pages<sp/>*<sp/>cb_interface[operand].fifo_page_size;</highlight></codeline>
<codeline lineno="261"><highlight class="normal"></highlight></codeline>
<codeline lineno="262"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>tt_reg_ptr<sp/>uint32_t*<sp/>pages_received_ptr<sp/>=<sp/>get_cb_tiles_received_ptr(operand);</highlight></codeline>
<codeline lineno="263"><highlight class="normal"><sp/><sp/><sp/><sp/>pages_received_ptr[0]<sp/>+=<sp/>num_pages;</highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="265"><highlight class="normal"><sp/><sp/><sp/><sp/>cb_interface[operand].fifo_wr_ptr<sp/>+=<sp/>num_words;</highlight></codeline>
<codeline lineno="266"><highlight class="normal"></highlight></codeline>
<codeline lineno="267"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>this<sp/>will<sp/>basically<sp/>reset<sp/>fifo_wr_ptr<sp/>to<sp/>fifo_addr<sp/>--<sp/>no<sp/>other<sp/>wrap<sp/>is<sp/>legal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>producer<sp/>always<sp/>writes<sp/>into<sp/>contiguous<sp/>memory,<sp/>it<sp/>cannot<sp/>wrap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="269"><highlight class="normal"><sp/><sp/><sp/><sp/>ASSERT(cb_interface[operand].fifo_wr_ptr<sp/>&lt;=<sp/>cb_interface[operand].fifo_limit);</highlight></codeline>
<codeline lineno="270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cb_interface[operand].fifo_wr_ptr<sp/>==<sp/>cb_interface[operand].fifo_limit)<sp/>{</highlight></codeline>
<codeline lineno="271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>change<sp/>this<sp/>to<sp/>fifo_wr_ptr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cb_interface[operand].fifo_wr_ptr<sp/>-=<sp/>cb_interface[operand].fifo_size;</highlight></codeline>
<codeline lineno="273"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="274"><highlight class="normal">}</highlight></codeline>
<codeline lineno="275"><highlight class="normal"></highlight></codeline>
<codeline lineno="298"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="299" refid="dataflow__api_8h_1aa3daf8e5e7299140cf2607be1a8656b0" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1aa3daf8e5e7299140cf2607be1a8656b0" kindref="member">cb_pop_front</ref>(int32_t<sp/>operand,<sp/>int32_t<sp/>num_pages)<sp/>{</highlight></codeline>
<codeline lineno="300"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>tt_reg_ptr<sp/>uint32_t*<sp/>pages_acked_ptr<sp/>=<sp/>get_cb_tiles_acked_ptr(operand);</highlight></codeline>
<codeline lineno="301"><highlight class="normal"><sp/><sp/><sp/><sp/>pages_acked_ptr[0]<sp/>+=<sp/>num_pages;</highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="303"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>num_words<sp/>=<sp/>num_pages<sp/>*<sp/>cb_interface[operand].fifo_page_size;</highlight></codeline>
<codeline lineno="304"><highlight class="normal"></highlight></codeline>
<codeline lineno="305"><highlight class="normal"><sp/><sp/><sp/><sp/>cb_interface[operand].fifo_rd_ptr<sp/>+=<sp/>num_words;</highlight></codeline>
<codeline lineno="306"><highlight class="normal"></highlight></codeline>
<codeline lineno="307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>this<sp/>will<sp/>basically<sp/>reset<sp/>fifo_rd_ptr<sp/>to<sp/>fifo_addr<sp/>--<sp/>no<sp/>other<sp/>wrap<sp/>is<sp/>legal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="308"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>consumer<sp/>always<sp/>reads<sp/>from<sp/>contiguous<sp/>memory,<sp/>it<sp/>cannot<sp/>wrap</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="309"><highlight class="normal"><sp/><sp/><sp/><sp/>ASSERT(cb_interface[operand].fifo_rd_ptr<sp/>&lt;=<sp/>cb_interface[operand].fifo_limit);</highlight></codeline>
<codeline lineno="310"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(cb_interface[operand].fifo_rd_ptr<sp/>==<sp/>cb_interface[operand].fifo_limit)<sp/>{</highlight></codeline>
<codeline lineno="311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>change<sp/>this<sp/>to<sp/>fifo_wr_ptr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cb_interface[operand].fifo_rd_ptr<sp/>-=<sp/>cb_interface[operand].fifo_size;</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="314"><highlight class="normal">}</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DATA_FORMATS_DEFINED</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="317"><highlight class="normal"></highlight></codeline>
<codeline lineno="318"><highlight class="normal"></highlight><highlight class="comment">//<sp/>this<sp/>API<sp/>is<sp/>used<sp/>by<sp/>both<sp/>the<sp/>reader<sp/>and<sp/>writer<sp/>side<sp/>of<sp/>the<sp/>CB</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="319"><highlight class="normal"></highlight><highlight class="comment">//<sp/>it<sp/>uses<sp/>unpack_src_format,<sp/>but<sp/>because<sp/>unpack_src_format<sp/>==<sp/>pack_dst_format,<sp/>we<sp/>can<sp/>use<sp/>either</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>std::int32_t<sp/>get_tile_size(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::int32_t<sp/>operand)<sp/>{</highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>input<sp/>=<sp/>operand;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"></highlight></codeline>
<codeline lineno="323"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>L1<sp/>16B<sp/>words</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="324"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>num_words<sp/>=<sp/>GET_TILE_SIZE((uint)unpack_src_format[input]);</highlight></codeline>
<codeline lineno="325"><highlight class="normal"></highlight></codeline>
<codeline lineno="326"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>return<sp/>bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="327"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>num_words;</highlight></codeline>
<codeline lineno="328"><highlight class="normal">}</highlight></codeline>
<codeline lineno="329"><highlight class="normal"></highlight></codeline>
<codeline lineno="330"><highlight class="normal"></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/>DataFormat<sp/>get_dataformat(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>std::int32_t<sp/>operand)<sp/>{</highlight></codeline>
<codeline lineno="331"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="normal">DataFormat</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">((uint)unpack_src_format[operand]);</highlight></codeline>
<codeline lineno="332"><highlight class="normal">}</highlight></codeline>
<codeline lineno="333"><highlight class="normal"></highlight></codeline>
<codeline lineno="334"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="335"><highlight class="normal"></highlight></codeline>
<codeline lineno="350"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="351" refid="dataflow__api_8h_1a593e43aff0c85e4b3f86d13f1d7350dd" refkind="member"><highlight class="normal">uint32_t<sp/><ref refid="dataflow__api_8h_1a593e43aff0c85e4b3f86d13f1d7350dd" kindref="member">get_write_ptr</ref>(uint32_t<sp/>operand)<sp/>{</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>return<sp/>byte<sp/>address<sp/>(fifo_wr_ptr<sp/>is<sp/>16B<sp/>address)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>wr_ptr_bytes<sp/>=<sp/>cb_interface[operand].fifo_wr_ptr<sp/>&lt;&lt;<sp/>4;</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>wr_ptr_bytes;</highlight></codeline>
<codeline lineno="355"><highlight class="normal">}</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="369"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="370" refid="dataflow__api_8h_1a66a31715a14cea1a63cbdca8c99b0827" refkind="member"><highlight class="normal">uint32_t<sp/><ref refid="dataflow__api_8h_1a66a31715a14cea1a63cbdca8c99b0827" kindref="member">get_read_ptr</ref>(uint32_t<sp/>operand)<sp/>{</highlight></codeline>
<codeline lineno="371"><highlight class="normal"></highlight></codeline>
<codeline lineno="372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>return<sp/>byte<sp/>address<sp/>(fifo_rd_ptr<sp/>is<sp/>16B<sp/>address)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="373"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>rd_ptr_bytes<sp/>=<sp/>cb_interface[operand].fifo_rd_ptr<sp/>&lt;&lt;<sp/>4;</highlight></codeline>
<codeline lineno="374"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rd_ptr_bytes;</highlight></codeline>
<codeline lineno="375"><highlight class="normal">}</highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight></codeline>
<codeline lineno="377"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>wait_for_sync_register_value(uint32_t<sp/>addr,<sp/>int32_t<sp/>val)<sp/>{</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>tt_reg_ptr<sp/>uint32_t*<sp/>reg_ptr<sp/>=<sp/>(</highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>uint32_t*)addr;</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/>int32_t<sp/>reg_value;</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;SW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>reg_value<sp/>=<sp/>reg_ptr[0];</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(reg_value<sp/>!=<sp/>val);</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;SD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="385"><highlight class="normal">}</highlight></codeline>
<codeline lineno="386"><highlight class="normal"></highlight></codeline>
<codeline lineno="400"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="401" refid="dataflow__api_8h_1a29521dee07b0070674a988f66c01ffed" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a29521dee07b0070674a988f66c01ffed" kindref="member">cb_reserve_back</ref>(int32_t<sp/>operand,<sp/>int32_t<sp/>num_pages)<sp/>{</highlight></codeline>
<codeline lineno="402"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>pages_acked_ptr<sp/>=<sp/>(uint32_t)<sp/>get_cb_tiles_acked_ptr(operand);</highlight></codeline>
<codeline lineno="403"><highlight class="normal"></highlight></codeline>
<codeline lineno="404"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>while<sp/>the<sp/>producer<sp/>(write-side<sp/>interface)<sp/>is<sp/>waiting<sp/>for<sp/>space<sp/>to<sp/>free<sp/>up<sp/>&quot;tiles_pushed&quot;<sp/>is<sp/>not<sp/>changing</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>&quot;tiles_pushed&quot;<sp/>is<sp/>updated<sp/>by<sp/>the<sp/>producer<sp/>only<sp/>when<sp/>the<sp/>tiles<sp/>are<sp/>pushed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="406"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>pages_received<sp/>=<sp/>get_cb_tiles_received_ptr(operand)[0];</highlight></codeline>
<codeline lineno="407"><highlight class="normal"></highlight></codeline>
<codeline lineno="408"><highlight class="normal"><sp/><sp/><sp/><sp/>int32_t<sp/>free_space_pages;</highlight></codeline>
<codeline lineno="409"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;CRBW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="410"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invalidate_l1_cache();</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>uint16_t&apos;s<sp/>here<sp/>because<sp/>Tensix<sp/>updates<sp/>the<sp/>val<sp/>at<sp/>tiles_acked_ptr<sp/>as<sp/>uint16<sp/>in<sp/>llk_pop_tiles</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>I<sp/>think<sp/>we<sp/>could<sp/>have<sp/>TRISC<sp/>update<sp/>tiles_acked_ptr,<sp/>and<sp/>we<sp/>wouldn&apos;t<sp/>need<sp/>uint16<sp/>here</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>pages_acked<sp/>=<sp/>(uint16_t)reg_read(pages_acked_ptr);</highlight></codeline>
<codeline lineno="415"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ARCH_GRAYSKULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>The<sp/>following<sp/>test<sp/>slows<sp/>down<sp/>by<sp/>5%<sp/>when<sp/>removing<sp/>the<sp/>barrier</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO(pgk)<sp/>investigate<sp/>GS<sp/>arbiter<sp/>WAR<sp/>in<sp/>compiler,<sp/>is<sp/>this<sp/>fixing<sp/>an<sp/>issue<sp/>there?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>models/experimental/stable_diffusion/tests/test_perf_unbatched_stable_diffusion.py::test_perf_bare_metal</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>uint32_t<sp/>local_mem_barrier<sp/>=<sp/>pages_acked;</highlight></codeline>
<codeline lineno="420"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint16_t<sp/>free_space_pages_wrap<sp/>=</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>cb_interface[operand].fifo_num_pages<sp/>-<sp/>(pages_received<sp/>-<sp/>pages_acked);</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>free_space_pages<sp/>=<sp/>(int32_t)free_space_pages_wrap;</highlight></codeline>
<codeline lineno="424"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(free_space_pages<sp/>&lt;<sp/>num_pages);</highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;CRBD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="426"><highlight class="normal">}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="450"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="451" refid="dataflow__api_8h_1af6d8057bd05a650c3501c5208f7d9f8a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1af6d8057bd05a650c3501c5208f7d9f8a" kindref="member">cb_wait_front</ref>(int32_t<sp/>operand,<sp/>int32_t<sp/>num_pages)<sp/>{</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>pages_acked<sp/>=<sp/>get_cb_tiles_acked_ptr(operand)[0];</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>pages_received_ptr<sp/>=<sp/>(uint32_t)<sp/>get_cb_tiles_received_ptr(operand);</highlight></codeline>
<codeline lineno="454"><highlight class="normal"></highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/><sp/><sp/>uint16_t<sp/>pages_received;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"></highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;CWFW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invalidate_l1_cache();</highlight></codeline>
<codeline lineno="460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pages_received<sp/>=<sp/>((uint16_t)reg_read(pages_received_ptr))<sp/>-<sp/>pages_acked;</highlight></codeline>
<codeline lineno="461"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(pages_received<sp/>&lt;<sp/>num_pages);</highlight></codeline>
<codeline lineno="462"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;CWFD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="463"><highlight class="normal">}</highlight></codeline>
<codeline lineno="464"><highlight class="normal"></highlight></codeline>
<codeline lineno="465"><highlight class="normal"></highlight><highlight class="comment">//<sp/>NOC<sp/>transfers</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="466"><highlight class="normal"></highlight></codeline>
<codeline lineno="467"><highlight class="normal"></highlight><highlight class="comment">//<sp/>simple<sp/>APIs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="468"><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="470"><highlight class="normal">std::uint64_t<sp/>get_noc_multicast_addr(</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>noc_x_start,</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>noc_y_start,</highlight></codeline>
<codeline lineno="473"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>noc_x_end,</highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>noc_y_end,</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>addr)<sp/>{</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="477"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Get<sp/>an<sp/>encoding<sp/>which<sp/>contains<sp/>tensix<sp/>core<sp/>and<sp/>address<sp/>you<sp/>want<sp/>to</highlight></codeline>
<codeline lineno="478"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>read<sp/>from/write<sp/>to<sp/>via<sp/>the<sp/>noc</highlight></codeline>
<codeline lineno="479"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NOC_MULTICAST_ADDR(NOC_X(noc_x_start),<sp/>NOC_Y(noc_y_start),<sp/>NOC_X(noc_x_end),<sp/>NOC_Y(noc_y_end),<sp/>addr);</highlight></codeline>
<codeline lineno="481"><highlight class="normal">}</highlight></codeline>
<codeline lineno="482"><highlight class="normal"></highlight></codeline>
<codeline lineno="483"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="484"><highlight class="normal">std::uint64_t<sp/>get_noc_addr(std::uint32_t<sp/>noc_x,<sp/>std::uint32_t<sp/>noc_y,<sp/>std::uint32_t<sp/>addr)<sp/>{</highlight></codeline>
<codeline lineno="485"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="486"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Get<sp/>an<sp/>encoding<sp/>which<sp/>contains<sp/>tensix<sp/>core<sp/>and<sp/>address<sp/>you<sp/>want<sp/>to</highlight></codeline>
<codeline lineno="487"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write<sp/>to<sp/>via<sp/>the<sp/>noc<sp/>multicast</highlight></codeline>
<codeline lineno="488"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="489"><highlight class="normal"></highlight></codeline>
<codeline lineno="490"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NOC_XY_ADDR(NOC_X(noc_x),<sp/>NOC_Y(noc_y),<sp/>addr);</highlight></codeline>
<codeline lineno="491"><highlight class="normal">}</highlight></codeline>
<codeline lineno="492"><highlight class="normal"></highlight></codeline>
<codeline lineno="493"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="494"><highlight class="comment"><sp/><sp/><sp/><sp/>Need<sp/>an<sp/>alias<sp/>to<sp/>get_noc_addr<sp/>so<sp/>that<sp/>the<sp/>structs<sp/>below<sp/>don&apos;t<sp/>confuse<sp/>the<sp/>above<sp/>get_noc_addr<sp/>with</highlight></codeline>
<codeline lineno="495"><highlight class="comment"><sp/><sp/><sp/><sp/>the<sp/>struct<sp/>variant</highlight></codeline>
<codeline lineno="496"><highlight class="comment">*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="497"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="498"><highlight class="normal">std::uint64_t<sp/>get_noc_addr_helper(std::uint32_t<sp/>noc_xy,<sp/>std::uint32_t<sp/>addr)<sp/>{</highlight></codeline>
<codeline lineno="499"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="500"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Get<sp/>an<sp/>encoding<sp/>which<sp/>contains<sp/>tensix<sp/>core<sp/>and<sp/>address<sp/>you<sp/>want<sp/>to</highlight></codeline>
<codeline lineno="501"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>write<sp/>to<sp/>via<sp/>the<sp/>noc<sp/>multicast</highlight></codeline>
<codeline lineno="502"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((uint64_t)(noc_xy)<sp/>&lt;&lt;<sp/>NOC_ADDR_COORD_SHIFT)<sp/>|<sp/>addr;</highlight></codeline>
<codeline lineno="504"><highlight class="normal">}</highlight></codeline>
<codeline lineno="505"><highlight class="normal"></highlight></codeline>
<codeline lineno="506"><highlight class="normal"></highlight></codeline>
<codeline lineno="507"><highlight class="normal"></highlight></codeline>
<codeline lineno="508"><highlight class="normal">uint64_t<sp/>get_dram_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>page_size,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_base_address,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="509"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;true&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="510"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;true&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="511"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>addr<sp/>=<sp/>(bank_offset_index<sp/>*<sp/>align(page_size,<sp/>ALLOCATOR_ALIGNMENT))<sp/>+<sp/>bank_base_address<sp/>+<sp/>offset<sp/>+<sp/>bank_to_dram_offset[bank_index];</highlight></codeline>
<codeline lineno="512"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;true&gt;(bank_index);</highlight></codeline>
<codeline lineno="513"><highlight class="normal"><sp/><sp/><sp/><sp/>uint64_t<sp/>noc_addr<sp/>=<sp/>get_noc_addr_helper(noc_xy,<sp/>addr);</highlight></codeline>
<codeline lineno="514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noc_addr;</highlight></codeline>
<codeline lineno="515"><highlight class="normal">}</highlight></codeline>
<codeline lineno="516"><highlight class="normal"></highlight></codeline>
<codeline lineno="517"><highlight class="normal">uint64_t<sp/>get_l1_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>page_size,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_base_address,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;false&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;false&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>addr<sp/>=<sp/>(bank_offset_index<sp/>*<sp/>align(page_size,<sp/>ALLOCATOR_ALIGNMENT))<sp/>+<sp/>bank_base_address<sp/>+<sp/>offset<sp/>+<sp/>bank_to_dram_offset[bank_index];</highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;false&gt;(bank_index);</highlight></codeline>
<codeline lineno="522"><highlight class="normal"><sp/><sp/><sp/><sp/>uint64_t<sp/>noc_addr<sp/>=<sp/>get_noc_addr_helper(noc_xy,<sp/>addr);</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noc_addr;</highlight></codeline>
<codeline lineno="524"><highlight class="normal">}</highlight></codeline>
<codeline lineno="525"><highlight class="normal"></highlight></codeline>
<codeline lineno="526"><highlight class="normal">uint64_t<sp/>get_system_memory_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>page_size,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>base_addr,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/><sp/><sp/>uint64_t<sp/>pcie_core_noc_encoding<sp/>=<sp/>uint64_t(NOC_XY_PCIE_ENCODING(NOC_X(PCIE_NOC_X),<sp/>NOC_Y(PCIE_NOC_Y),<sp/>noc_index));</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>addr<sp/>=<sp/>base_addr<sp/>+<sp/>page_size<sp/>*<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal"><sp/>+<sp/>offset;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><sp/><sp/>uint64_t<sp/>noc_addr<sp/>=<sp/>pcie_core_noc_encoding<sp/>|<sp/>addr;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noc_addr;</highlight></codeline>
<codeline lineno="531"><highlight class="normal">}</highlight></codeline>
<codeline lineno="532"><highlight class="normal"></highlight></codeline>
<codeline lineno="533"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="534"><highlight class="normal">std::uint64_t<sp/>get_noc_addr(std::uint32_t<sp/>addr)<sp/>{</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="536"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Get<sp/>an<sp/>encoding<sp/>which<sp/>contains<sp/>the<sp/>address<sp/>in<sp/>L1<sp/>on<sp/>the<sp/>current<sp/>core<sp/>that<sp/>you<sp/>want<sp/>to</highlight></codeline>
<codeline lineno="537"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>read<sp/>from/write<sp/>to<sp/>via<sp/>the<sp/>noc</highlight></codeline>
<codeline lineno="538"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NOC_XY_ADDR(my_x[noc_index],<sp/>my_y[noc_index],<sp/>addr);</highlight></codeline>
<codeline lineno="540"><highlight class="normal">}</highlight></codeline>
<codeline lineno="541"><highlight class="normal"></highlight></codeline>
<codeline lineno="558"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="559" refid="dataflow__api_8h_1ab97e89d297b36a2143d7f57011dd7ec5" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1ab97e89d297b36a2143d7f57011dd7ec5" kindref="member">noc_async_read</ref>(std::uint64_t<sp/>src_noc_addr,<sp/>std::uint32_t<sp/>dst_local_l1_addr,<sp/>std::uint32_t<sp/>size)<sp/>{</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="561"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>requests<sp/>-<sp/>use<sp/>static<sp/>VC</highlight></codeline>
<codeline lineno="562"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>responses<sp/>-<sp/>assigned<sp/>VCs<sp/>dynamically</highlight></codeline>
<codeline lineno="563"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_READ_TRANSACTION(noc_index,<sp/>src_noc_addr,<sp/>dst_local_l1_addr,<sp/>size);</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/>ncrisc_noc_fast_read_any_len(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>src_noc_addr,<sp/>dst_local_l1_addr,<sp/>size);</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="568"><highlight class="normal">}</highlight></codeline>
<codeline lineno="569"><highlight class="normal"></highlight></codeline>
<codeline lineno="570"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>write<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="571"><highlight class="normal"></highlight><highlight class="comment">//<sp/>this<sp/>issues<sp/>only<sp/>a<sp/>single<sp/>packet<sp/>with<sp/>size<sp/>&lt;=<sp/>NOC_MAX_BURST_SIZE<sp/>(ie<sp/>maximum<sp/>packet<sp/>size)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="572"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="573"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_one_packet(std::uint64_t<sp/>src_noc_addr,<sp/>std::uint32_t<sp/>dst_local_l1_addr,<sp/>std::uint32_t<sp/>size)<sp/>{</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="575"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>requests<sp/>-<sp/>use<sp/>static<sp/>VC</highlight></codeline>
<codeline lineno="576"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>responses<sp/>-<sp/>assigned<sp/>VCs<sp/>dynamically</highlight></codeline>
<codeline lineno="577"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="582"><highlight class="normal"></highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_READ_TRANSACTION(noc_index,<sp/>src_noc_addr,<sp/>dst_local_l1_addr,<sp/>size);</highlight></codeline>
<codeline lineno="585"><highlight class="normal"></highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dst_local_l1_addr);</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>(uint32_t)src_noc_addr);</highlight></codeline>
<codeline lineno="588"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ARCH_BLACKHOLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Handles<sp/>reading<sp/>from<sp/>PCIe</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_MID,<sp/>(uint32_t)(src_noc_addr<sp/>&gt;&gt;<sp/>32)<sp/>&amp;<sp/>0x1000000F);</highlight></codeline>
<codeline lineno="591"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_COORDINATE,<sp/>(uint32_t)(src_noc_addr<sp/>&gt;&gt;<sp/>NOC_ADDR_COORD_SHIFT)<sp/>&amp;<sp/>NOC_COORDINATE_MASK);</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/>size);</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="595"><highlight class="normal"><sp/><sp/><sp/><sp/>noc_reads_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="596"><highlight class="normal"></highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="598"><highlight class="normal">}</highlight></codeline>
<codeline lineno="599"><highlight class="normal"></highlight></codeline>
<codeline lineno="600"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>write<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="601"><highlight class="normal"></highlight><highlight class="comment">//<sp/>this<sp/>issues<sp/>only<sp/>a<sp/>single<sp/>packet<sp/>with<sp/>size<sp/>&lt;=<sp/>NOC_MAX_BURST_SIZE<sp/>(ie<sp/>maximum<sp/>packet<sp/>size)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="603"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_one_packet_set_state(std::uint64_t<sp/>src_noc_addr,<sp/>std::uint32_t<sp/>size)<sp/>{</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="605"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>requests<sp/>-<sp/>use<sp/>static<sp/>VC</highlight></codeline>
<codeline lineno="606"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>responses<sp/>-<sp/>assigned<sp/>VCs<sp/>dynamically</highlight></codeline>
<codeline lineno="607"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="612"><highlight class="normal"></highlight></codeline>
<codeline lineno="613"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="614"><highlight class="normal"></highlight></codeline>
<codeline lineno="615"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ARCH_BLACKHOLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Handles<sp/>reading<sp/>from<sp/>PCIe</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_MID,<sp/>(uint32_t)(src_noc_addr<sp/>&gt;&gt;<sp/>32)<sp/>&amp;<sp/>0x1000000F);</highlight></codeline>
<codeline lineno="618"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_COORDINATE,<sp/>(uint32_t)(src_noc_addr<sp/>&gt;&gt;<sp/>NOC_ADDR_COORD_SHIFT)<sp/>&amp;<sp/>NOC_COORDINATE_MASK);</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/>size);</highlight></codeline>
<codeline lineno="621"><highlight class="normal"></highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="623"><highlight class="normal">}</highlight></codeline>
<codeline lineno="624"><highlight class="normal"></highlight></codeline>
<codeline lineno="625"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>write<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="626"><highlight class="normal"></highlight><highlight class="comment">//<sp/>this<sp/>issues<sp/>only<sp/>a<sp/>single<sp/>packet<sp/>with<sp/>size<sp/>&lt;=<sp/>NOC_MAX_BURST_SIZE<sp/>(ie<sp/>maximum<sp/>packet<sp/>size)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>inc_num_issued<sp/>=<sp/>true&gt;</highlight></codeline>
<codeline lineno="628"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="629"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_one_packet_with_state(std::uint32_t<sp/>src_noc_addr,<sp/>std::uint32_t<sp/>dst_local_l1_addr)<sp/>{</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="631"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>requests<sp/>-<sp/>use<sp/>static<sp/>VC</highlight></codeline>
<codeline lineno="632"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>responses<sp/>-<sp/>assigned<sp/>VCs<sp/>dynamically</highlight></codeline>
<codeline lineno="633"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="634"><highlight class="normal"></highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="638"><highlight class="normal"></highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="640"><highlight class="normal"></highlight></codeline>
<codeline lineno="641"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>In<sp/>order<sp/>to<sp/>sanitize,<sp/>need<sp/>to<sp/>grab<sp/>full<sp/>noc<sp/>addr<sp/>+<sp/>xfer<sp/>size<sp/>from<sp/>state.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_READ_TRANSACTION_WITH_ADDR_AND_SIZE_STATE(noc_index,<sp/>src_noc_addr,<sp/>dst_local_l1_addr);</highlight></codeline>
<codeline lineno="643"><highlight class="normal"></highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dst_local_l1_addr);</highlight></codeline>
<codeline lineno="645"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_noc_addr);</highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="647"><highlight class="normal"></highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(inc_num_issued)<sp/>{</highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_reads_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="651"><highlight class="normal"></highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="653"><highlight class="normal">}</highlight></codeline>
<codeline lineno="654"><highlight class="normal"></highlight></codeline>
<codeline lineno="655"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>write<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="657"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_set_state(std::uint64_t<sp/>src_noc_addr)<sp/>{</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="659"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>requests<sp/>-<sp/>use<sp/>static<sp/>VC</highlight></codeline>
<codeline lineno="660"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>responses<sp/>-<sp/>assigned<sp/>VCs<sp/>dynamically</highlight></codeline>
<codeline lineno="661"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="662"><highlight class="normal"></highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="667"><highlight class="normal"></highlight></codeline>
<codeline lineno="668"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ARCH_BLACKHOLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Handles<sp/>reading<sp/>from<sp/>PCIe</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_MID,<sp/>(uint32_t)(src_noc_addr<sp/>&gt;&gt;<sp/>32)<sp/>&amp;<sp/>0x1000000F);</highlight></codeline>
<codeline lineno="671"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_COORDINATE,<sp/>(uint32_t)(src_noc_addr<sp/>&gt;&gt;<sp/>NOC_ADDR_COORD_SHIFT)<sp/>&amp;<sp/>NOC_COORDINATE_MASK);</highlight></codeline>
<codeline lineno="673"><highlight class="normal"></highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="675"><highlight class="normal">}</highlight></codeline>
<codeline lineno="676"><highlight class="normal"></highlight></codeline>
<codeline lineno="677"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>write<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>inc_num_issued<sp/>=<sp/>true&gt;</highlight></codeline>
<codeline lineno="679"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="680"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_with_state(std::uint32_t<sp/>src_noc_addr,<sp/>std::uint32_t<sp/>dst_local_l1_addr,<sp/>std::uint32_t<sp/>size)<sp/>{</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="682"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>requests<sp/>-<sp/>use<sp/>static<sp/>VC</highlight></codeline>
<codeline lineno="683"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>responses<sp/>-<sp/>assigned<sp/>VCs<sp/>dynamically</highlight></codeline>
<codeline lineno="684"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="686"><highlight class="normal"></highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>In<sp/>order<sp/>to<sp/>sanitize,<sp/>need<sp/>to<sp/>grab<sp/>full<sp/>noc<sp/>addr<sp/>+<sp/>xfer<sp/>size<sp/>from<sp/>state.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_READ_TRANSACTION_WITH_ADDR_STATE(noc_index,<sp/>src_noc_addr,<sp/>dst_local_l1_addr,<sp/>size);</highlight></codeline>
<codeline lineno="689"><highlight class="normal"></highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(size<sp/>&gt;<sp/>NOC_MAX_BURST_SIZE)<sp/>{</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="694"><highlight class="normal"></highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dst_local_l1_addr);</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_noc_addr);</highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/>NOC_MAX_BURST_SIZE);</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size<sp/>-=<sp/>NOC_MAX_BURST_SIZE;</highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>src_noc_addr<sp/>+=<sp/>NOC_MAX_BURST_SIZE;</highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dst_local_l1_addr<sp/>+=<sp/>NOC_MAX_BURST_SIZE;</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(inc_num_issued)<sp/>{</highlight></codeline>
<codeline lineno="703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_reads_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="706"><highlight class="normal"></highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>left-over<sp/>packet</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="711"><highlight class="normal"></highlight></codeline>
<codeline lineno="712"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dst_local_l1_addr);</highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_noc_addr);</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/>size);</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(inc_num_issued)<sp/>{</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_reads_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="719"><highlight class="normal"></highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NARD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="721"><highlight class="normal">}</highlight></codeline>
<codeline lineno="722"><highlight class="normal"></highlight></codeline>
<codeline lineno="723"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="724"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_inc_num_issued(std::uint32_t<sp/>num_issued_reads_inc)<sp/>{</highlight></codeline>
<codeline lineno="725"><highlight class="normal"><sp/><sp/><sp/><sp/>noc_reads_num_issued[noc_index]<sp/>+=<sp/>num_issued_reads_inc;</highlight></codeline>
<codeline lineno="726"><highlight class="normal">}</highlight></codeline>
<codeline lineno="727"><highlight class="normal"></highlight></codeline>
<codeline lineno="728"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>write<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="729"><highlight class="normal"></highlight><highlight class="comment">//<sp/>this<sp/>issues<sp/>only<sp/>a<sp/>single<sp/>packet<sp/>with<sp/>size<sp/>&lt;=<sp/>NOC_MAX_BURST_SIZE<sp/>(ie<sp/>maximum<sp/>packet<sp/>size)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="730"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="731"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_write_one_packet(std::uint32_t<sp/>src_local_l1_addr,<sp/>std::uint64_t<sp/>dst_noc_addr,<sp/>std::uint32_t<sp/>size)<sp/>{</highlight></codeline>
<codeline lineno="732"><highlight class="normal"></highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_WRITE_TRANSACTION(noc_index,<sp/>dst_noc_addr,<sp/>src_local_l1_addr,<sp/>size);</highlight></codeline>
<codeline lineno="735"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_WR_CMD_BUF));</highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="737"><highlight class="normal"></highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_cmd_field<sp/>=<sp/>NOC_CMD_CPY<sp/>|<sp/>NOC_CMD_WR<sp/>|<sp/>NOC_CMD_VC_STATIC<sp/>|</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_STATIC_VC(NOC_UNICAST_WRITE_VC)<sp/>|<sp/>0x0<sp/>|<sp/><sp/></highlight><highlight class="comment">//<sp/>(linked<sp/>?<sp/>NOC_CMD_VC_LINKED<sp/>:<sp/>0x0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x0<sp/>|<sp/><sp/></highlight><highlight class="comment">//<sp/>(mcast<sp/>?<sp/>(NOC_CMD_PATH_RESERVE<sp/>|<sp/>NOC_CMD_BRCST_PACKET)<sp/>:<sp/>0x0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_RESP_MARKED;</highlight></codeline>
<codeline lineno="742"><highlight class="normal"></highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CTRL,<sp/>noc_cmd_field);</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_local_l1_addr);</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>(uint32_t)dst_noc_addr);</highlight></codeline>
<codeline lineno="746"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ARCH_BLACKHOLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Handles<sp/>writing<sp/>to<sp/>PCIe</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_MID,<sp/>(uint32_t)(dst_noc_addr<sp/>&gt;&gt;<sp/>32)<sp/>&amp;<sp/>0x1000000F);</highlight></codeline>
<codeline lineno="749"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_COORDINATE,<sp/>(uint32_t)(dst_noc_addr<sp/>&gt;&gt;<sp/>NOC_ADDR_COORD_SHIFT)<sp/>&amp;<sp/>NOC_COORDINATE_MASK);</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/><sp/>size);</highlight></codeline>
<codeline lineno="752"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/>noc_nonposted_writes_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/>noc_nonposted_writes_acked[noc_index]<sp/>+=<sp/>1;<sp/><sp/></highlight><highlight class="comment">//<sp/>num_dests</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="755"><highlight class="normal">}</highlight></codeline>
<codeline lineno="756"><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>write<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="758"><highlight class="normal"></highlight><highlight class="comment">//<sp/>this<sp/>issues<sp/>only<sp/>a<sp/>single<sp/>packet<sp/>with<sp/>size<sp/>&lt;=<sp/>NOC_MAX_BURST_SIZE<sp/>(ie<sp/>maximum<sp/>packet<sp/>size)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="759"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="760"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_write_multicast_one_packet(</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>src_local_l1_addr,</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint64_t<sp/>dst_noc_addr_multicast,</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>size,</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>num_dests,</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>linked<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="766"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>multicast_path_reserve<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NMPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_MULTI_WRITE_TRANSACTION(noc_index,<sp/>dst_noc_addr_multicast,<sp/>src_local_l1_addr,<sp/>size);</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_WR_CMD_BUF));</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="771"><highlight class="normal"></highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_cmd_field<sp/>=</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_CPY<sp/>|<sp/>NOC_CMD_WR<sp/>|</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_VC_STATIC<sp/>|</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_STATIC_VC(NOC_MULTICAST_WRITE_VC)<sp/>|</highlight></codeline>
<codeline lineno="776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(linked<sp/>?<sp/>NOC_CMD_VC_LINKED<sp/>:<sp/>0x0)<sp/>|</highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>((multicast_path_reserve<sp/>?<sp/>NOC_CMD_PATH_RESERVE<sp/>:<sp/>0)<sp/>|<sp/>NOC_CMD_BRCST_PACKET)<sp/>|</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_RESP_MARKED;</highlight></codeline>
<codeline lineno="779"><highlight class="normal"></highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CTRL,<sp/>noc_cmd_field);</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_local_l1_addr);</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>(uint32_t)dst_noc_addr_multicast);</highlight></codeline>
<codeline lineno="783"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ARCH_BLACKHOLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Handles<sp/>writing<sp/>to<sp/>PCIe</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_MID,<sp/>(uint32_t)(dst_noc_addr_multicast<sp/>&gt;&gt;<sp/>32)<sp/>&amp;<sp/>0x1000000F);</highlight></codeline>
<codeline lineno="786"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_COORDINATE,<sp/>(uint32_t)(dst_noc_addr_multicast<sp/>&gt;&gt;<sp/>NOC_ADDR_COORD_SHIFT)<sp/>&amp;<sp/>NOC_COORDINATE_MASK);</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/><sp/>size);</highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/>noc_nonposted_writes_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/>noc_nonposted_writes_acked[noc_index]<sp/>+=<sp/>num_dests;</highlight></codeline>
<codeline lineno="792"><highlight class="normal">}</highlight></codeline>
<codeline lineno="793"><highlight class="normal"></highlight></codeline>
<codeline lineno="794"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>write<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="795"><highlight class="normal"></highlight><highlight class="comment">//<sp/>this<sp/>sets<sp/>the<sp/>state<sp/>for<sp/>issuing<sp/>a<sp/>single<sp/>packet<sp/>with<sp/>size<sp/>&lt;=<sp/>NOC_MAX_BURST_SIZE<sp/>(ie<sp/>maximum<sp/>packet<sp/>size)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="796"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>non_posted<sp/>=<sp/>true&gt;</highlight></codeline>
<codeline lineno="797"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="798"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_write_one_packet_set_state(std::uint64_t<sp/>dst_noc_addr,<sp/>std::uint32_t<sp/>size)<sp/>{</highlight></codeline>
<codeline lineno="799"><highlight class="normal"></highlight></codeline>
<codeline lineno="800"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_WR_CMD_BUF));</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="803"><highlight class="normal"></highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_cmd_field<sp/>=<sp/>NOC_CMD_CPY<sp/>|<sp/>NOC_CMD_WR<sp/>|<sp/>NOC_CMD_VC_STATIC<sp/>|</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_STATIC_VC(NOC_UNICAST_WRITE_VC)<sp/>|<sp/>0x0<sp/>|<sp/><sp/></highlight><highlight class="comment">//<sp/>(linked<sp/>?<sp/>NOC_CMD_VC_LINKED<sp/>:<sp/>0x0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x0<sp/>|<sp/><sp/></highlight><highlight class="comment">//<sp/>(mcast<sp/>?<sp/>(NOC_CMD_PATH_RESERVE<sp/>|<sp/>NOC_CMD_BRCST_PACKET)<sp/>:<sp/>0x0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(non_posted<sp/>?<sp/>NOC_CMD_RESP_MARKED<sp/>:<sp/>0x0);</highlight></codeline>
<codeline lineno="808"><highlight class="normal"></highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CTRL,<sp/>noc_cmd_field);</highlight></codeline>
<codeline lineno="810"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>ARCH_BLACKHOLE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Handles<sp/>writing<sp/>to<sp/>PCIe</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_MID,<sp/>(uint32_t)(dst_noc_addr<sp/>&gt;&gt;<sp/>32)<sp/>&amp;<sp/>0x1000000F);</highlight></codeline>
<codeline lineno="813"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_COORDINATE,<sp/>(uint32_t)(dst_noc_addr<sp/>&gt;&gt;<sp/>NOC_ADDR_COORD_SHIFT)<sp/>&amp;<sp/>NOC_COORDINATE_MASK);</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/><sp/>size);</highlight></codeline>
<codeline lineno="816"><highlight class="normal">}</highlight></codeline>
<codeline lineno="817"><highlight class="normal"></highlight></codeline>
<codeline lineno="818"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>write<sp/>docs</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="819"><highlight class="normal"></highlight><highlight class="comment">//<sp/>this<sp/>issues<sp/>only<sp/>a<sp/>single<sp/>packet<sp/>with<sp/>cmd<sp/>buf<sp/>state<sp/>with<sp/>size<sp/>&lt;=<sp/>NOC_MAX_BURST_SIZE<sp/>(ie<sp/>maximum<sp/>packet<sp/>size)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="820"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>non_posted<sp/>=<sp/>true&gt;</highlight></codeline>
<codeline lineno="821"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="822"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_write_one_packet_with_state(std::uint32_t<sp/>src_local_l1_addr,<sp/>std::uint32_t<sp/>dst_noc_addr)<sp/>{</highlight></codeline>
<codeline lineno="823"><highlight class="normal"></highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_WR_CMD_BUF));</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="827"><highlight class="normal"></highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>In<sp/>order<sp/>to<sp/>sanitize,<sp/>need<sp/>to<sp/>grab<sp/>full<sp/>noc<sp/>addr<sp/>+<sp/>xfer<sp/>size<sp/>from<sp/>state.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_WRITE_TRANSACTION_WITH_ADDR_AND_SIZE_STATE(noc_index,<sp/>dst_noc_addr,<sp/>src_local_l1_addr);</highlight></codeline>
<codeline lineno="830"><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_local_l1_addr);</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dst_noc_addr);</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="834"><highlight class="normal"></highlight></codeline>
<codeline lineno="835"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(non_posted)<sp/>{</highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_nonposted_writes_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_nonposted_writes_acked[noc_index]<sp/>+=<sp/>1;<sp/><sp/></highlight><highlight class="comment">//<sp/>num_dests</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="839"><highlight class="normal">}</highlight></codeline>
<codeline lineno="840"><highlight class="normal"></highlight></codeline>
<codeline lineno="841"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="842" refid="structInterleavedAddrGen" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structInterleavedAddrGen" kindref="compound">InterleavedAddrGen</ref><sp/>{</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_base_address;<sp/><sp/></highlight><highlight class="comment">//<sp/>Base<sp/>address<sp/>for<sp/>the<sp/>whole<sp/>tensor.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>page_size;<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Num<sp/>bytes<sp/>in<sp/>page.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>aligned_page_size<sp/>=<sp/>align(page_size,<sp/>ALLOCATOR_ALIGNMENT);</highlight></codeline>
<codeline lineno="846"><highlight class="normal"></highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>get_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_offset_index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(bank_offset_index<sp/>*<sp/>this-&gt;aligned_page_size)<sp/>+<sp/>this-&gt;bank_base_address<sp/>+<sp/>offset<sp/>+<sp/>interleaved_addr_gen::get_bank_offset&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="851"><highlight class="normal"></highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint64_t<sp/>get_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>addr<sp/>=<sp/>this-&gt;get_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index,<sp/>bank_index,<sp/>offset);</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="858"><highlight class="normal"></highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint64_t<sp/>noc_addr<sp/>=<sp/>get_noc_addr_helper(noc_xy,<sp/>addr);</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noc_addr;</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="862"><highlight class="normal"></highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_page(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>dest_addr,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dataflow__api_8h_1ab97e89d297b36a2143d7f57011dd7ec5" kindref="member">noc_async_read</ref>(this-&gt;get_noc_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>offset),<sp/>dest_addr,<sp/>page_size);</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="867"><highlight class="normal">};</highlight></codeline>
<codeline lineno="868"><highlight class="normal"></highlight></codeline>
<codeline lineno="869"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="870" refid="structInterleavedPow2AddrGen" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structInterleavedPow2AddrGen" kindref="compound">InterleavedPow2AddrGen</ref><sp/>{</highlight></codeline>
<codeline lineno="871"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_base_address;</highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>log_base_2_of_page_size;<sp/><sp/></highlight><highlight class="comment">//<sp/>WARNING:<sp/>This<sp/>struct<sp/>is<sp/>used<sp/>for<sp/>optimized<sp/>get_noc_addr<sp/>in<sp/>which<sp/>case</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>you<sp/>know<sp/>that<sp/>bank_unit_size<sp/>is<sp/>a<sp/>power<sp/>of<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>aligned_log_base_2_of_page_size<sp/>=<sp/>this-&gt;log_base_2_of_page_size<sp/>&gt;<sp/>LOG_BASE_2_OF_ALLOCATOR_ALIGNMENT</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>?<sp/>this-&gt;log_base_2_of_page_size</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>LOG_BASE_2_OF_ALLOCATOR_ALIGNMENT;</highlight></codeline>
<codeline lineno="877"><highlight class="normal"></highlight></codeline>
<codeline lineno="878"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>get_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_offset_index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(bank_offset_index<sp/>&lt;&lt;<sp/>this-&gt;aligned_log_base_2_of_page_size)<sp/>+<sp/>this-&gt;bank_base_address<sp/>+<sp/>offset<sp/>+<sp/>interleaved_addr_gen::get_bank_offset&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="882"><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint64_t<sp/>get_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>addr<sp/>=<sp/>this-&gt;get_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index,<sp/>bank_index,<sp/>offset);</highlight></codeline>
<codeline lineno="888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="889"><highlight class="normal"></highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint64_t<sp/>noc_addr<sp/>=<sp/>get_noc_addr_helper(noc_xy,<sp/>addr);</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noc_addr;</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="893"><highlight class="normal">};</highlight></codeline>
<codeline lineno="894"><highlight class="normal"></highlight></codeline>
<codeline lineno="895"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="896" refid="structInterleavedAddrGenFast" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structInterleavedAddrGenFast" kindref="compound">InterleavedAddrGenFast</ref><sp/>{</highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_base_address;<sp/><sp/></highlight><highlight class="comment">//<sp/>Base<sp/>address<sp/>for<sp/>the<sp/>whole<sp/>tensor.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>TODO:<sp/>Remove<sp/>page_size<sp/>from<sp/>argument<sp/>list.<sp/>This<sp/>can<sp/>be<sp/>derived<sp/>from<sp/>data_format</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>page_size;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Num<sp/>bytes<sp/>in<sp/>bank<sp/>unit.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/>DataFormat<sp/>data_format;<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Data<sp/>format</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="901"><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>get_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_offset_index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>MUL_WITH_TILE_SIZE((uint)this-&gt;data_format,<sp/>bank_offset_index)<sp/>+<sp/>this-&gt;bank_base_address<sp/>+<sp/>offset<sp/>+<sp/>interleaved_addr_gen::get_bank_offset&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="906"><highlight class="normal"></highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="908"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint64_t<sp/>get_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>addr<sp/>=<sp/>this-&gt;get_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index,<sp/>bank_index,<sp/>offset);</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="913"><highlight class="normal"></highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint64_t<sp/>noc_addr<sp/>=<sp/>get_noc_addr_helper(noc_xy,<sp/>addr);</highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noc_addr;</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="917"><highlight class="normal"></highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_tile(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>uint32_t<sp/>dest_addr,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>src_addr<sp/>=<sp/>this-&gt;get_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index,<sp/>bank_index,<sp/>offset);</highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>src_noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="924"><highlight class="normal"></highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRTW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_READ_TRANSACTION(noc_index,<sp/>get_noc_addr_helper(src_noc_xy,<sp/>src_addr),<sp/>dest_addr,<sp/>this-&gt;page_size);</highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRTD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="929"><highlight class="normal"></highlight></codeline>
<codeline lineno="930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dest_addr);</highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_addr);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>(uint32_t)src_addr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_COORDINATE,<sp/>src_noc_xy);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>src_addr<sp/>&gt;&gt;<sp/>32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/>this-&gt;page_size);<sp/><sp/></highlight><highlight class="comment">//<sp/>len_bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_reads_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="937"><highlight class="normal"></highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_write_tile(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>uint32_t<sp/>src_addr)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>dest_addr<sp/>=<sp/>this-&gt;get_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index,<sp/>bank_index);</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>dest_noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="944"><highlight class="normal"></highlight></codeline>
<codeline lineno="945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWTW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_WRITE_TRANSACTION(noc_index,<sp/>get_noc_addr_helper(dest_noc_xy,<sp/>dest_addr),<sp/>src_addr,<sp/>this-&gt;page_size);</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_WR_CMD_BUF));</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWTD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="949"><highlight class="normal"></highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>uint32_t<sp/>noc_cmd_field<sp/>=<sp/>NOC_CMD_CPY<sp/>|<sp/>NOC_CMD_WR<sp/>|<sp/>NOC_CMD_VC_STATIC<sp/>|</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_STATIC_VC(NOC_UNICAST_WRITE_VC)<sp/>|<sp/>0x0<sp/>|<sp/><sp/></highlight><highlight class="comment">//<sp/>(linked<sp/>?<sp/>NOC_CMD_VC_LINKED<sp/>:<sp/>0x0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x0<sp/>|<sp/><sp/></highlight><highlight class="comment">//<sp/>(mcast<sp/>?<sp/>(NOC_CMD_PATH_RESERVE<sp/>|<sp/>NOC_CMD_BRCST_PACKET)<sp/>:<sp/>0x0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_RESP_MARKED;</highlight></codeline>
<codeline lineno="954"><highlight class="normal"></highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CTRL,<sp/>noc_cmd_field);</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_addr);</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dest_addr);<sp/><sp/></highlight><highlight class="comment">//<sp/>(uint32_t)dest_addr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_COORDINATE,<sp/>dest_noc_xy);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>dest_addr<sp/>&gt;&gt;<sp/>32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/>this-&gt;page_size);<sp/><sp/></highlight><highlight class="comment">//<sp/>len_bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_nonposted_writes_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_nonposted_writes_acked[noc_index]<sp/>+=<sp/>1;<sp/><sp/></highlight><highlight class="comment">//<sp/>num_dests</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="964"><highlight class="normal">};</highlight></codeline>
<codeline lineno="965"><highlight class="normal"></highlight></codeline>
<codeline lineno="966"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>add<sp/>noc_async_write_page</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="967"><highlight class="normal"></highlight><highlight class="comment">//<sp/>TODO:<sp/>need<sp/>static<sp/>assert<sp/>+<sp/>host<sp/>assert<sp/>that<sp/>page<sp/>size<sp/>&lt;=<sp/>8192,<sp/>hard<sp/>constraint</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="968"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="969" refid="structInterleavedPow2AddrGenFast" refkind="compound"><highlight class="normal"></highlight><highlight class="keyword">struct<sp/></highlight><highlight class="normal"><ref refid="structInterleavedPow2AddrGenFast" kindref="compound">InterleavedPow2AddrGenFast</ref><sp/>{</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_base_address;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>Base<sp/>address<sp/>for<sp/>the<sp/>whole<sp/>tensor.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>log_base_2_of_page_size;<sp/></highlight><highlight class="comment">//<sp/>Num<sp/>bytes<sp/>in<sp/>bank<sp/>unit.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>aligned_log_base_2_of_page_size<sp/>=<sp/>this-&gt;log_base_2_of_page_size<sp/>&gt;<sp/>LOG_BASE_2_OF_ALLOCATOR_ALIGNMENT</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>?<sp/>this-&gt;log_base_2_of_page_size</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>:<sp/>LOG_BASE_2_OF_ALLOCATOR_ALIGNMENT;</highlight></codeline>
<codeline lineno="975"><highlight class="normal"></highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>get_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_offset_index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>bank_index,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(bank_offset_index<sp/>&lt;&lt;<sp/>this-&gt;aligned_log_base_2_of_page_size)<sp/>+<sp/>this-&gt;bank_base_address<sp/>+<sp/>offset<sp/>+<sp/>interleaved_addr_gen::get_bank_offset&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="980"><highlight class="normal"></highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint64_t<sp/>get_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="983"><highlight class="normal"></highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>addr<sp/>=<sp/>this-&gt;get_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index,<sp/>bank_index,<sp/>offset);</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="988"><highlight class="normal"></highlight></codeline>
<codeline lineno="989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint64_t<sp/>noc_addr<sp/>=<sp/>get_noc_addr_helper(noc_xy,<sp/>addr);</highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>noc_addr;</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="992"><highlight class="normal"></highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_page(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>uint32_t<sp/>dest_addr,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>src_addr<sp/>=<sp/>this-&gt;get_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index,<sp/>bank_index,<sp/>offset);</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>src_noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="999"><highlight class="normal"></highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_READ_TRANSACTION(noc_index,<sp/>get_noc_addr_helper(src_noc_xy,<sp/>src_addr),<sp/>dest_addr,<sp/>1<sp/>&lt;&lt;<sp/>this-&gt;aligned_log_base_2_of_page_size);</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"></highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dest_addr);</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_addr);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>(uint32_t)src_addr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_COORDINATE,<sp/>src_noc_xy);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>src_addr<sp/>&gt;&gt;<sp/>32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/>1<sp/>&lt;&lt;<sp/>this-&gt;aligned_log_base_2_of_page_size);<sp/><sp/></highlight><highlight class="comment">//<sp/>len_bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_reads_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"></highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_partial_page(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>uint32_t<sp/>dest_addr,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>size,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>src_addr<sp/>=<sp/>this-&gt;get_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index,<sp/>bank_index,<sp/>offset);</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>src_noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"></highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;RPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_READ_TRANSACTION(noc_index,<sp/>get_noc_addr_helper(src_noc_xy,<sp/>src_addr),<sp/>dest_addr,<sp/>size);</highlight></codeline>
<codeline lineno="1024"><highlight class="normal"></highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dest_addr);</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_addr);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>(uint32_t)src_addr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_COORDINATE,<sp/>src_noc_xy);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>src_addr<sp/>&gt;&gt;<sp/>32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/>size);<sp/><sp/></highlight><highlight class="comment">//<sp/>len_bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_reads_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"></highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/>FORCE_INLINE</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_write_page(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>uint32_t<sp/>src_addr,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>write_size_bytes,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>offset<sp/>=<sp/>0)</highlight><highlight class="keyword"><sp/>const<sp/></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_offset_index<sp/>=<sp/>interleaved_addr_gen::get_bank_offset_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>bank_index<sp/>=<sp/>interleaved_addr_gen::get_bank_index&lt;DRAM&gt;(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index);</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>dest_addr<sp/>=<sp/>this-&gt;get_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>bank_offset_index,<sp/>bank_index,<sp/>offset);</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>dest_noc_xy<sp/>=<sp/>interleaved_addr_gen::get_noc_xy&lt;DRAM&gt;(bank_index);</highlight></codeline>
<codeline lineno="1039"><highlight class="normal"></highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWPW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_WRITE_TRANSACTION(noc_index,<sp/>get_noc_addr_helper(dest_noc_xy,<sp/>dest_addr),<sp/>src_addr,<sp/>write_size_bytes);</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_WR_CMD_BUF));</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWPD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"></highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>uint32_t<sp/>noc_cmd_field<sp/>=<sp/>NOC_CMD_CPY<sp/>|<sp/>NOC_CMD_WR<sp/>|<sp/>NOC_CMD_VC_STATIC<sp/>|</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_STATIC_VC(NOC_UNICAST_WRITE_VC)<sp/>|<sp/>0x0<sp/>|<sp/><sp/></highlight><highlight class="comment">//<sp/>(linked<sp/>?<sp/>NOC_CMD_VC_LINKED<sp/>:<sp/>0x0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>0x0<sp/>|<sp/><sp/></highlight><highlight class="comment">//<sp/>(mcast<sp/>?<sp/>(NOC_CMD_PATH_RESERVE<sp/>|<sp/>NOC_CMD_BRCST_PACKET)<sp/>:<sp/>0x0)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_RESP_MARKED;</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"></highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CTRL,<sp/>noc_cmd_field);</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_addr);</highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dest_addr);<sp/><sp/></highlight><highlight class="comment">//<sp/>(uint32_t)dest_addr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_RET_ADDR_COORDINATE,<sp/>dest_noc_xy);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>dest_addr<sp/>&gt;&gt;<sp/>32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/><sp/>write_size_bytes);<sp/><sp/></highlight><highlight class="comment">//<sp/>len_bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_WR_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_nonposted_writes_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_nonposted_writes_acked[noc_index]<sp/>+=<sp/>1;<sp/><sp/></highlight><highlight class="comment">//<sp/>num_dests</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1059"><highlight class="normal">};</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"></highlight></codeline>
<codeline lineno="1061"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="1062"><highlight class="normal">FORCE_INLINE<sp/>std::uint64_t<sp/>get_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structInterleavedAddrGen" kindref="compound">InterleavedAddrGen&lt;DRAM&gt;</ref>&amp;<sp/>s,<sp/>uint32_t<sp/>offset<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1064"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Alternative<sp/>API<sp/>for<sp/>getting<sp/>the<sp/>noc<sp/>address<sp/>when<sp/>we<sp/>are<sp/>reading<sp/>using<sp/>a<sp/>swizzled</highlight></codeline>
<codeline lineno="1065"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>layout.<sp/>This<sp/>version<sp/>assumes<sp/>bank<sp/>unit<sp/>size<sp/>can<sp/>be<sp/>arbitrary<sp/>size.<sp/>Use</highlight></codeline>
<codeline lineno="1066"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>get_noc_addr(const<sp/>uint32_t<sp/>id,<sp/>InterleavedPow2AddrGen<sp/>s)<sp/>for<sp/>optimized<sp/>algorithm<sp/>in<sp/>which<sp/>stick<sp/>size</highlight></codeline>
<codeline lineno="1067"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>a<sp/>power<sp/>of<sp/>2.</highlight></codeline>
<codeline lineno="1068"><highlight class="comment"></highlight></codeline>
<codeline lineno="1069"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>id:<sp/>Unique<sp/>id<sp/>for<sp/>the<sp/>bank_unit<sp/>you<sp/>want<sp/>to<sp/>read,<sp/>assuming<sp/>row<sp/>major<sp/>order.<sp/>We<sp/>use<sp/>this<sp/>to<sp/>compute<sp/>the</highlight></codeline>
<codeline lineno="1070"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bank<sp/>for<sp/>this<sp/>unit<sp/>of<sp/>data.</highlight></codeline>
<codeline lineno="1071"><highlight class="comment"></highlight></codeline>
<codeline lineno="1072"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterleavedAddrGen:<sp/>Check<sp/>struct<sp/>for<sp/>attribute<sp/>definitions.</highlight></codeline>
<codeline lineno="1073"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s.get_noc_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>offset);</highlight></codeline>
<codeline lineno="1075"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"></highlight></codeline>
<codeline lineno="1077"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="1078"><highlight class="normal">FORCE_INLINE<sp/>std::uint64_t<sp/>get_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structInterleavedPow2AddrGen" kindref="compound">InterleavedPow2AddrGen&lt;DRAM&gt;</ref>&amp;<sp/>s,<sp/>uint32_t<sp/>offset<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1080"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Alternative<sp/>API<sp/>for<sp/>getting<sp/>the<sp/>noc<sp/>address<sp/>when<sp/>we<sp/>are<sp/>reading<sp/>using<sp/>a<sp/>swizzled</highlight></codeline>
<codeline lineno="1081"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>layout.<sp/>This<sp/>version<sp/>assumes<sp/>bank<sp/>unit<sp/>size<sp/>is<sp/>a<sp/>power<sp/>of<sp/>2.<sp/>For<sp/>arbitrary<sp/>bank</highlight></codeline>
<codeline lineno="1082"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>unit<sp/>size,<sp/>use<sp/>get_noc_addr(const<sp/>uint32_t<sp/>id,<sp/>const<sp/>InterleavedOffset<sp/>s)</highlight></codeline>
<codeline lineno="1083"><highlight class="comment"></highlight></codeline>
<codeline lineno="1084"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>id:<sp/>Unique<sp/>id<sp/>for<sp/>the<sp/>bank_unit<sp/>you<sp/>want<sp/>to<sp/>read,<sp/>assuming<sp/>row<sp/>major<sp/>order.<sp/>We<sp/>use<sp/>this<sp/>to<sp/>compute<sp/>the</highlight></codeline>
<codeline lineno="1085"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bank<sp/>for<sp/>this<sp/>unit<sp/>of<sp/>data.</highlight></codeline>
<codeline lineno="1086"><highlight class="comment"></highlight></codeline>
<codeline lineno="1087"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterleavedPow2AddrGen:<sp/>Check<sp/>struct<sp/>for<sp/>attribute<sp/>definitions.</highlight></codeline>
<codeline lineno="1088"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1089"><highlight class="normal"></highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s.get_noc_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>offset);</highlight></codeline>
<codeline lineno="1091"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"></highlight></codeline>
<codeline lineno="1093"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="1094"><highlight class="normal">FORCE_INLINE<sp/>std::uint64_t<sp/>get_noc_addr(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structInterleavedAddrGenFast" kindref="compound">InterleavedAddrGenFast&lt;DRAM&gt;</ref>&amp;<sp/>s,<sp/>uint32_t<sp/>offset<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1096"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Alternative<sp/>API<sp/>for<sp/>getting<sp/>the<sp/>noc<sp/>address<sp/>when<sp/>we<sp/>are<sp/>reading<sp/>using<sp/>a<sp/>swizzled</highlight></codeline>
<codeline lineno="1097"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>layout.<sp/>This<sp/>version<sp/>assumes<sp/>bank<sp/>unit<sp/>size<sp/>can<sp/>be<sp/>arbitrary<sp/>size.<sp/>Use</highlight></codeline>
<codeline lineno="1098"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>get_noc_addr(const<sp/>uint32_t<sp/>id,<sp/>InterleavedPow2AddrGen<sp/>s)<sp/>for<sp/>optimized<sp/>algorithm<sp/>in<sp/>which<sp/>stick<sp/>size</highlight></codeline>
<codeline lineno="1099"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>is<sp/>a<sp/>power<sp/>of<sp/>2.</highlight></codeline>
<codeline lineno="1100"><highlight class="comment"></highlight></codeline>
<codeline lineno="1101"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>id:<sp/>Unique<sp/>id<sp/>for<sp/>the<sp/>bank_unit<sp/>you<sp/>want<sp/>to<sp/>read,<sp/>assuming<sp/>row<sp/>major<sp/>order.<sp/>We<sp/>use<sp/>this<sp/>to<sp/>compute<sp/>the</highlight></codeline>
<codeline lineno="1102"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bank<sp/>for<sp/>this<sp/>unit<sp/>of<sp/>data.</highlight></codeline>
<codeline lineno="1103"><highlight class="comment"></highlight></codeline>
<codeline lineno="1104"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>InterleavedAddrGen:<sp/>Check<sp/>struct<sp/>for<sp/>attribute<sp/>definitions.</highlight></codeline>
<codeline lineno="1105"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>s.get_noc_addr(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>offset);</highlight></codeline>
<codeline lineno="1107"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"></highlight></codeline>
<codeline lineno="1109"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="1110"><highlight class="normal">FORCE_INLINE<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_page(</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structInterleavedAddrGen" kindref="compound">InterleavedAddrGen&lt;DRAM&gt;</ref>&amp;<sp/>s,<sp/>std::uint32_t<sp/>dst_local_l1_addr,<sp/>uint32_t<sp/>offset<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1113"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>requests<sp/>-<sp/>use<sp/>static<sp/>VC</highlight></codeline>
<codeline lineno="1114"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>responses<sp/>-<sp/>assigned<sp/>VCs<sp/>dynamically</highlight></codeline>
<codeline lineno="1115"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/>s.noc_async_read_page(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>dst_local_l1_addr,<sp/>offset);</highlight></codeline>
<codeline lineno="1117"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"></highlight></codeline>
<codeline lineno="1119"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="1120"><highlight class="normal">FORCE_INLINE<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_tile(</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structInterleavedAddrGenFast" kindref="compound">InterleavedAddrGenFast&lt;DRAM&gt;</ref>&amp;<sp/>s,<sp/>std::uint32_t<sp/>dst_local_l1_addr,<sp/>uint32_t<sp/>offset<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1123"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>requests<sp/>-<sp/>use<sp/>static<sp/>VC</highlight></codeline>
<codeline lineno="1124"><highlight class="comment"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Read<sp/>responses<sp/>-<sp/>assigned<sp/>VCs<sp/>dynamically</highlight></codeline>
<codeline lineno="1125"><highlight class="comment"><sp/><sp/><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/>s.noc_async_read_tile(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>dst_local_l1_addr,<sp/>offset);</highlight></codeline>
<codeline lineno="1127"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"></highlight></codeline>
<codeline lineno="1147"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;u</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">32_t<sp/>max_page_size=NOC_MAX_BURST_SIZE<sp/>+<sp/>1&gt;</highlight></codeline>
<codeline lineno="1148"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1149" refid="dataflow__api_8h_1ae5353d488f5a68e6eb89fae5ea1be951" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1ae5353d488f5a68e6eb89fae5ea1be951" kindref="member">noc_async_write</ref>(std::uint32_t<sp/>src_local_l1_addr,<sp/>std::uint64_t<sp/>dst_noc_addr,<sp/>std::uint32_t<sp/>size)<sp/>{</highlight></codeline>
<codeline lineno="1150"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(max_page_size<sp/>&lt;=<sp/>NOC_MAX_BURST_SIZE)<sp/>{</highlight></codeline>
<codeline lineno="1151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_async_write_one_packet(src_local_l1_addr,<sp/>dst_noc_addr,<sp/>size);</highlight></codeline>
<codeline lineno="1152"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NAWW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_WRITE_TRANSACTION(noc_index,<sp/>dst_noc_addr,<sp/>src_local_l1_addr,size);</highlight></codeline>
<codeline lineno="1155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ncrisc_noc_fast_write_any_len(</highlight></codeline>
<codeline lineno="1156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_index,</highlight></codeline>
<codeline lineno="1157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NCRISC_WR_CMD_BUF,</highlight></codeline>
<codeline lineno="1158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>src_local_l1_addr,</highlight></codeline>
<codeline lineno="1159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dst_noc_addr,</highlight></codeline>
<codeline lineno="1160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size,</highlight></codeline>
<codeline lineno="1161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_UNICAST_WRITE_VC,</highlight></codeline>
<codeline lineno="1162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,</highlight></codeline>
<codeline lineno="1165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NAWD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1167"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1168"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1169"><highlight class="normal"></highlight></codeline>
<codeline lineno="1170"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>DRAM&gt;</highlight></codeline>
<codeline lineno="1171"><highlight class="normal">FORCE_INLINE<sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_write_tile(</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/></highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="structInterleavedAddrGenFast" kindref="compound">InterleavedAddrGenFast&lt;DRAM&gt;</ref>&amp;<sp/>s,<sp/>std::uint32_t<sp/>src_local_l1_addr)<sp/>{</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/>s.noc_async_write_tile(</highlight><highlight class="keywordtype">id</highlight><highlight class="normal">,<sp/>src_local_l1_addr);</highlight></codeline>
<codeline lineno="1174"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"></highlight></codeline>
<codeline lineno="1176"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;ProgrammableCoreType<sp/>type<sp/>=<sp/>ProgrammableCoreType::TENSIX&gt;</highlight></codeline>
<codeline lineno="1177"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1178"><highlight class="normal">uint32_t<sp/>get_semaphore(uint32_t<sp/>semaphore_id)<sp/>{</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(uint32_t)sem_l1_base[</highlight><highlight class="keyword">static_cast&lt;</highlight><highlight class="keywordtype">int</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(type)]<sp/>+<sp/>semaphore_id<sp/>*<sp/>L1_ALIGNMENT;</highlight></codeline>
<codeline lineno="1180"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"></highlight></codeline>
<codeline lineno="1182"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1183"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_semaphore_set_remote(std::uint32_t<sp/>src_local_l1_addr,<sp/>std::uint64_t<sp/>dst_noc_addr)<sp/>{</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSSW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_WRITE_TRANSACTION(noc_index,<sp/>dst_noc_addr,<sp/>src_local_l1_addr,<sp/>4);</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/>ncrisc_noc_fast_write_any_len(</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_index,</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NCRISC_WR_REG_CMD_BUF,</highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>src_local_l1_addr,</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dst_noc_addr,</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4<sp/></highlight><highlight class="comment">/*<sp/>size<sp/>in<sp/>bytes<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_UNICAST_WRITE_VC,</highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>1,</highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSSD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1198"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"></highlight></codeline>
<codeline lineno="1232"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;u</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">32_t<sp/>max_page_size=NOC_MAX_BURST_SIZE<sp/>+<sp/>1&gt;</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1234" refid="dataflow__api_8h_1aebb548dd7fb5654248c32b147531c8d2" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1aebb548dd7fb5654248c32b147531c8d2" kindref="member">noc_async_write_multicast</ref>(</highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>src_local_l1_addr,</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint64_t<sp/>dst_noc_addr_multicast,</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>size,</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>num_dests,</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>linked<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>multicast_path_reserve<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal"><sp/>(max_page_size<sp/>&lt;=<sp/>NOC_MAX_BURST_SIZE)<sp/>{</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_async_write_multicast_one_packet(src_local_l1_addr,<sp/>dst_noc_addr_multicast,<sp/>size,<sp/>num_dests,<sp/>linked,<sp/>multicast_path_reserve);</highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NMWW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_MULTI_WRITE_TRANSACTION(noc_index,<sp/>dst_noc_addr_multicast,<sp/>src_local_l1_addr,size);</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ncrisc_noc_fast_write_any_len(</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_index,</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NCRISC_WR_CMD_BUF,</highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>src_local_l1_addr,</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dst_noc_addr_multicast,</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size,</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_MULTICAST_WRITE_VC,</highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>linked,</highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num_dests,</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>multicast_path_reserve);</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NMWD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1259"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"></highlight></codeline>
<codeline lineno="1285"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1286" refid="dataflow__api_8h_1af1debd77eb9592540a899290fb2a1709" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1af1debd77eb9592540a899290fb2a1709" kindref="member">noc_semaphore_set_multicast</ref>(</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>src_local_l1_addr,<sp/>std::uint64_t<sp/>dst_noc_addr_multicast,<sp/>std::uint32_t<sp/>num_dests,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>linked<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>multicast_path_reserve<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSMW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_MULTI_WRITE_TRANSACTION(noc_index,<sp/>dst_noc_addr_multicast,<sp/>src_local_l1_addr,<sp/>4);</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/>ncrisc_noc_fast_write_any_len(</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_index,</highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NCRISC_WR_REG_CMD_BUF,</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>src_local_l1_addr,</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dst_noc_addr_multicast,</highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4<sp/></highlight><highlight class="comment">/*size<sp/>in<sp/>bytes*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_MULTICAST_WRITE_VC,</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>linked,</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num_dests,</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>multicast_path_reserve);</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSMD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1302"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1327"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1328" refid="dataflow__api_8h_1ab629fc4e0e17a8ed09e5a6b264927b18" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1ab629fc4e0e17a8ed09e5a6b264927b18" kindref="member">noc_semaphore_set_multicast_loopback_src</ref>(</highlight></codeline>
<codeline lineno="1329"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>src_local_l1_addr,<sp/>std::uint64_t<sp/>dst_noc_addr_multicast,<sp/>std::uint32_t<sp/>num_dests,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>linked<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>multicast_path_reserve<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1330"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSMW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1331"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_MULTI_WRITE_TRANSACTION(noc_index,<sp/>dst_noc_addr_multicast,<sp/>src_local_l1_addr,<sp/>4);</highlight></codeline>
<codeline lineno="1332"><highlight class="normal"><sp/><sp/><sp/><sp/>ncrisc_noc_fast_write_any_len_loopback_src(</highlight></codeline>
<codeline lineno="1333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_index,</highlight></codeline>
<codeline lineno="1334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NCRISC_WR_REG_CMD_BUF,</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>src_local_l1_addr,</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dst_noc_addr_multicast,</highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>4<sp/></highlight><highlight class="comment">/*size<sp/>in<sp/>bytes*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_MULTICAST_WRITE_VC,</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>linked,</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num_dests,</highlight></codeline>
<codeline lineno="1342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>multicast_path_reserve);</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSMD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1344"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1347"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_write_multicast_loopback_src(</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>src_local_l1_addr,</highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint64_t<sp/>dst_noc_addr_multicast,</highlight></codeline>
<codeline lineno="1350"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>size,</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"><sp/><sp/><sp/><sp/>std::uint32_t<sp/>num_dests,</highlight></codeline>
<codeline lineno="1352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>linked<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>multicast_path_reserve<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1354"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NMLW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1355"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_MULTI_WRITE_TRANSACTION(noc_index,<sp/>dst_noc_addr_multicast,<sp/>src_local_l1_addr,<sp/>size);</highlight></codeline>
<codeline lineno="1356"><highlight class="normal"><sp/><sp/><sp/><sp/>ncrisc_noc_fast_write_any_len_loopback_src(</highlight></codeline>
<codeline lineno="1357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_index,</highlight></codeline>
<codeline lineno="1358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NCRISC_WR_CMD_BUF,</highlight></codeline>
<codeline lineno="1359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>src_local_l1_addr,</highlight></codeline>
<codeline lineno="1360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>dst_noc_addr_multicast,</highlight></codeline>
<codeline lineno="1361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>size,</highlight></codeline>
<codeline lineno="1362"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_MULTICAST_WRITE_VC,</highlight></codeline>
<codeline lineno="1363"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>linked,</highlight></codeline>
<codeline lineno="1365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>num_dests,</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>multicast_path_reserve);</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NMLD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1368"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"></highlight></codeline>
<codeline lineno="1378"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1379" refid="dataflow__api_8h_1a8da61f7d36de3d865b04acf3656c7950" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a8da61f7d36de3d865b04acf3656c7950" kindref="member">noc_async_read_barrier</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRBW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>BH<sp/>cache<sp/>is<sp/>write-through<sp/>so<sp/>reader<sp/>must<sp/>invalidate<sp/>if<sp/>reading<sp/>any<sp/>address<sp/>that<sp/>was<sp/>previously<sp/>read</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invalidate_l1_cache();</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!ncrisc_noc_reads_flushed(noc_index));</highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRBD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1386"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1387"><highlight class="normal"></highlight></codeline>
<codeline lineno="1396"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1397" refid="dataflow__api_8h_1a8a1af3e9115ddcd9d2e4b0c8b4a4b680" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a8a1af3e9115ddcd9d2e4b0c8b4a4b680" kindref="member">noc_async_write_barrier</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWBW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!ncrisc_noc_nonposted_writes_flushed(noc_index))</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWBD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1402"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"></highlight></codeline>
<codeline lineno="1409"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1410" refid="dataflow__api_8h_1a82c38db0fda2eaafccd0aac9635f0dc1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a82c38db0fda2eaafccd0aac9635f0dc1" kindref="member">noc_async_writes_flushed</ref>()<sp/>{</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWFW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!ncrisc_noc_nonposted_writes_sent(noc_index))</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;</highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWFD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1415"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1416"><highlight class="normal"></highlight></codeline>
<codeline lineno="1425"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1426" refid="dataflow__api_8h_1a13a74d46d62931d19a406414db103c4b" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a13a74d46d62931d19a406414db103c4b" kindref="member">noc_async_atomic_barrier</ref>(uint8_t<sp/>noc_idx<sp/>=<sp/>noc_index)<sp/>{</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NABW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!ncrisc_noc_nonposted_atomics_flushed(noc_idx))</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>;</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NABD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1431"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"></highlight></codeline>
<codeline lineno="1446"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1447" refid="dataflow__api_8h_1a4f714cc4a08a2eaac5e3f7fae9d1383a" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a4f714cc4a08a2eaac5e3f7fae9d1383a" kindref="member">noc_semaphore_wait</ref>(</highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>tt_l1_ptr<sp/>uint32_t*<sp/>sem_addr,<sp/>uint32_t<sp/>val)<sp/>{</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invalidate_l1_cache();</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((*sem_addr)<sp/>!=<sp/>val);</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1453"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1454"><highlight class="normal"></highlight></codeline>
<codeline lineno="1468"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1469" refid="dataflow__api_8h_1a84a965a61b65152c42835f35dca007af" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a84a965a61b65152c42835f35dca007af" kindref="member">noc_semaphore_wait_min</ref>(</highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>tt_l1_ptr<sp/>uint32_t*<sp/>sem_addr,<sp/>uint32_t<sp/>val)<sp/>{</highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSMW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invalidate_l1_cache();</highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>((*sem_addr)<sp/>&lt;<sp/>val);</highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSMD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1475"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"></highlight></codeline>
<codeline lineno="1490"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1491" refid="dataflow__api_8h_1af02a9af640679b00da874318535aa397" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1af02a9af640679b00da874318535aa397" kindref="member">noc_semaphore_set</ref>(</highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>tt_l1_ptr<sp/>uint32_t*<sp/>sem_addr,<sp/>uint32_t<sp/>val)<sp/>{</highlight></codeline>
<codeline lineno="1492"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>semaphore<sp/>value<sp/>to<sp/>val</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1493"><highlight class="normal"><sp/><sp/><sp/><sp/>(*sem_addr)<sp/>=<sp/>val;</highlight></codeline>
<codeline lineno="1494"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1495"><highlight class="normal"></highlight></codeline>
<codeline lineno="1496"><highlight class="normal"></highlight></codeline>
<codeline lineno="1517"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1518" refid="dataflow__api_8h_1a1f11981622b01c9e42d44a939ec30be1" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a1f11981622b01c9e42d44a939ec30be1" kindref="member">noc_inline_dw_write</ref>(uint64_t<sp/>addr,<sp/>uint32_t<sp/>val,<sp/>uint8_t<sp/>be<sp/>=<sp/>0xF)<sp/>{</highlight></codeline>
<codeline lineno="1519"><highlight class="normal"></highlight></codeline>
<codeline lineno="1520"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWIW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1521"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_ADDR(noc_index,<sp/>addr,<sp/>4);</highlight></codeline>
<codeline lineno="1522"><highlight class="normal"><sp/><sp/><sp/><sp/>noc_fast_write_dw_inline(</highlight></codeline>
<codeline lineno="1523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>noc_index,</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NCRISC_WR_REG_CMD_BUF,</highlight></codeline>
<codeline lineno="1525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>val,</highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>addr,</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>be,<sp/></highlight><highlight class="comment">//<sp/>byte-enable</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_UNICAST_WRITE_VC,</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">,<sp/></highlight><highlight class="comment">//<sp/>mcast</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">//<sp/>posted</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>);</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NWID&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1533"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"></highlight></codeline>
<codeline lineno="1535"><highlight class="normal"></highlight></codeline>
<codeline lineno="1536"><highlight class="normal"></highlight></codeline>
<codeline lineno="1550"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1551" refid="dataflow__api_8h_1a962d804ce21d1d26ccb4241e2eb6ac9f" refkind="member"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/><ref refid="dataflow__api_8h_1a962d804ce21d1d26ccb4241e2eb6ac9f" kindref="member">noc_semaphore_inc</ref>(uint64_t<sp/>addr,<sp/>uint32_t<sp/>incr,<sp/>uint8_t<sp/>noc_id<sp/>=<sp/>noc_index)<sp/>{</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="1553"><highlight class="comment"><sp/><sp/><sp/><sp/>[REFER<sp/>TO<sp/>grayskull/noc/noc.h<sp/>for<sp/>the<sp/>documentation<sp/>of<sp/>noc_atomic_increment()]</highlight></codeline>
<codeline lineno="1554"><highlight class="comment"><sp/><sp/><sp/><sp/>Generic<sp/>increment<sp/>with<sp/>32-bit<sp/>wrap.</highlight></codeline>
<codeline lineno="1555"><highlight class="comment"><sp/><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSIW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_SANITIZE_NOC_ADDR(noc_id,<sp/>addr,<sp/>4);</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/><sp/><sp/>DEBUG_INSERT_DELAY(TransactionAtomic);</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"><sp/><sp/><sp/><sp/>noc_fast_atomic_increment(noc_id,<sp/>NCRISC_AT_CMD_BUF,<sp/>addr,<sp/>NOC_UNICAST_WRITE_VC,<sp/>incr,<sp/>31<sp/></highlight><highlight class="comment">/*wrap*/</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*linked*/</highlight><highlight class="normal">,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal"><sp/></highlight><highlight class="comment">/*posted*/</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1560"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSID&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1561"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1562"><highlight class="normal"></highlight></codeline>
<codeline lineno="1563"><highlight class="normal"></highlight><highlight class="keyword">inline</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>RISC_POST_HEARTBEAT(uint32_t<sp/>&amp;heartbeat)<sp/>{</highlight></codeline>
<codeline lineno="1564"><highlight class="normal"><sp/><sp/>invalidate_l1_cache();</highlight></codeline>
<codeline lineno="1565"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>uint32_t*<sp/>ptr<sp/>=<sp/>(</highlight><highlight class="keyword">volatile</highlight><highlight class="normal"><sp/>uint32_t*)(0x1C);</highlight></codeline>
<codeline lineno="1566"><highlight class="normal"><sp/><sp/>heartbeat++;</highlight></codeline>
<codeline lineno="1567"><highlight class="normal"><sp/><sp/>ptr[0]<sp/>=<sp/>0xAABB0000<sp/>|<sp/>(heartbeat<sp/>&amp;<sp/>0xFFFF);</highlight></codeline>
<codeline lineno="1568"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1569"><highlight class="normal"></highlight></codeline>
<codeline lineno="1570"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1571"><highlight class="normal">uint32_t<sp/>min(uint32_t<sp/>a,<sp/>uint32_t<sp/>b)<sp/>{<sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(a<sp/>&lt;<sp/>b)<sp/>?<sp/>a:<sp/>b;<sp/>}</highlight></codeline>
<codeline lineno="1572"><highlight class="normal"></highlight></codeline>
<codeline lineno="1573"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/>&lt;u</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">32_t<sp/>page_size,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>use_vc&gt;</highlight></codeline>
<codeline lineno="1574"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1575"><highlight class="normal">uint32_t<sp/>noc_async_read_tile_dram_sharded_set_state(uint32_t<sp/>bank_base_address,<sp/>uint32_t<sp/>bank_id<sp/>=<sp/>0,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>uint32_t<sp/>vc<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1576"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>src_addr_;</highlight></codeline>
<codeline lineno="1577"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>src_noc_xy;</highlight></codeline>
<codeline lineno="1578"><highlight class="normal"></highlight></codeline>
<codeline lineno="1579"><highlight class="normal"><sp/><sp/><sp/><sp/>src_addr_<sp/>=<sp/>bank_base_address<sp/>+<sp/>bank_to_dram_offset[bank_id];</highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/>src_noc_xy<sp/>=<sp/>dram_bank_to_noc_xy[noc_index][bank_id];</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"></highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRTW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRTD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"></highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">constexpr</highlight><highlight class="normal">(use_vc)<sp/>{</highlight></codeline>
<codeline lineno="1587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>uint32_t<sp/>noc_rd_cmd_field<sp/>=<sp/>NOC_CMD_CPY<sp/>|<sp/>NOC_CMD_RD<sp/>|<sp/>NOC_CMD_RESP_MARKED<sp/>|<sp/>NOC_CMD_VC_STATIC<sp/>|<sp/>NOC_CMD_STATIC_VC(vc);</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_CTRL,<sp/>noc_rd_cmd_field);</highlight></codeline>
<codeline lineno="1589"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1590"><highlight class="normal"></highlight></codeline>
<codeline lineno="1591"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_COORDINATE,<sp/>src_noc_xy);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>src_addr<sp/>&gt;&gt;<sp/>32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1592"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_AT_LEN_BE,<sp/>page_size);<sp/><sp/></highlight><highlight class="comment">//<sp/>len_bytes</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1593"><highlight class="normal"></highlight></codeline>
<codeline lineno="1594"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>src_addr_;</highlight></codeline>
<codeline lineno="1595"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1596"><highlight class="normal"></highlight></codeline>
<codeline lineno="1597"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1598"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_tile_dram_sharded_with_state(uint32_t<sp/>src_base_addr,<sp/>uint32_t<sp/>src_addr,<sp/>uint32_t<sp/>dest_addr,<sp/>uint32_t<sp/>trid<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1599"><highlight class="normal"><sp/><sp/><sp/><sp/>uint32_t<sp/>src_addr_;</highlight></codeline>
<codeline lineno="1600"><highlight class="normal"></highlight></codeline>
<codeline lineno="1601"><highlight class="normal"><sp/><sp/><sp/><sp/>src_addr_<sp/>=<sp/>src_base_addr<sp/>+<sp/>src_addr;</highlight></codeline>
<codeline lineno="1602"><highlight class="normal"></highlight></codeline>
<codeline lineno="1603"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRTW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!noc_cmd_buf_ready(noc_index,<sp/>NCRISC_RD_CMD_BUF));</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRTD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"></highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_RET_ADDR_LO,<sp/>dest_addr);</highlight></codeline>
<codeline lineno="1608"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_TARG_ADDR_LO,<sp/>src_addr_);<sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>(uint32_t)src_addr</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/><sp/><sp/>NOC_CMD_BUF_WRITE_REG(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>NOC_CMD_CTRL,<sp/>NOC_CTRL_SEND_REQ);</highlight></codeline>
<codeline lineno="1610"><highlight class="normal"><sp/><sp/><sp/><sp/>noc_reads_num_issued[noc_index]<sp/>+=<sp/>1;</highlight></codeline>
<codeline lineno="1611"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1612"><highlight class="normal"></highlight></codeline>
<codeline lineno="1613"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1614"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_tile_dram_sharded_with_state_with_trid(uint32_t<sp/>src_base_addr,<sp/>uint32_t<sp/>src_addr,<sp/>uint32_t<sp/>dest_addr,<sp/>uint32_t<sp/>trid<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1615"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRDW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1616"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#ifndef<sp/>ARCH_GRAYSKULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1617"><highlight class="normal"><sp/><sp/><sp/><sp/>ncrisc_noc_fast_read_with_transaction_id(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>src_base_addr,<sp/>src_addr,<sp/>dest_addr,<sp/>trid);</highlight></codeline>
<codeline lineno="1618"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1619"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NRDD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1620"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1621"><highlight class="normal"></highlight></codeline>
<codeline lineno="1622"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_tile_dram_sharded_set_trid(uint32_t<sp/>trid<sp/>=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSTW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#ifndef<sp/>ARCH_GRAYSKULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/><sp/><sp/>ncrisc_noc_set_transaction_id(noc_index,<sp/>NCRISC_RD_CMD_BUF,<sp/>trid);</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NSTD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1629"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"></highlight></codeline>
<codeline lineno="1631"><highlight class="normal">FORCE_INLINE</highlight></codeline>
<codeline lineno="1632"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>noc_async_read_barrier_with_trid(uint32_t<sp/>trid)<sp/>{</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NBTW&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1634"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#ifndef<sp/>ARCH_GRAYSKULL</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">do</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>invalidate_l1_cache();</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/>}<sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!ncrisc_noc_read_with_transaction_id_flushed(noc_index,<sp/>trid));</highlight></codeline>
<codeline lineno="1638"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/><sp/><sp/>#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/>WAYPOINT(</highlight><highlight class="stringliteral">&quot;NBTD&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1640"><highlight class="normal">}</highlight></codeline>
    </programlisting>
    <location file="tt_metal/hw/inc/dataflow_api.h"/>
  </compounddef>
</doxygen>
