<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Using ttnn &mdash; TT-NN  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/tt_theme.css?v=ea036265" />

  
    <link rel="shortcut icon" href="../_static/cropped-favicon-32x32.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js?v=b3ba4146"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=4825356b"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Tensor" href="tensor.html" />
    <link rel="prev" title="Getting Started" href="get_started.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



<a href="https://tenstorrent.github.io/docs-test/core/latest/">
    <img src="../_static/tt_logo.svg" class="logo" alt="Logo"/>
</a>

<a href="../index.html">
    TT-NN
</a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">TTNN</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="about.html">What is ttnn?</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_started.html">Getting Started</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using ttnn</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#basic-examples">Basic Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#converting-from-and-to-torch-tensor">1. Converting from and to torch tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-an-operation-on-the-device">2. Running an operation on the device</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-getitem-to-slice-the-tensor">3. Using __getitem__ to slice the tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enabling-program-cache">4. Enabling program cache</a></li>
<li class="toctree-l3"><a class="reference internal" href="#debugging-intermediate-tensors">5. Debugging intermediate tensors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracing-the-graph-of-operations">6. Tracing the graph of operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#using-tt-lib-operation-in-ttnn">7. Using tt_lib operation in ttnn</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enabling-logging">8. Enabling Logging</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-python-operators">9. Supported Python Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#changing-the-string-representation-of-the-tensor">10. Changing the string representation of the tensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualize-using-web-browser">11. Visualize using Web Browser</a></li>
<li class="toctree-l3"><a class="reference internal" href="#register-pre-and-or-post-operation-hooks">12. Register pre- and/or post-operation hooks</a></li>
<li class="toctree-l3"><a class="reference internal" href="#query-all-operations">13. Query all operations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#disable-fallbacks">14. Disable Fallbacks</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tensor.html">Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">APIs</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="onboarding.html">Onboarding New Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="converting_torch_model_to_ttnn.html">Converting torch Model to ttnn</a></li>
<li class="toctree-l1"><a class="reference internal" href="adding_new_ttnn_operation.html">Adding New ttnn Operation</a></li>
<li class="toctree-l1"><a class="reference internal" href="profiling_ttnn_operations.html">Profiling ttnn Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="dependencies/index.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="demos.html">Building and Uplifting Demos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ttnn_sweeps/index.html">Placeholder title</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Models</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tt_metal_models/get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tt_metal_models/get_performance.html">Performance</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../resources/support.html">Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../resources/contributing.html">Contributing as a developer</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TT-NN</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Using ttnn</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/ttnn/usage.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="using-ttnn">
<span id="id1"></span><h1>Using ttnn<a class="headerlink" href="#using-ttnn" title="Permalink to this heading"></a>
</h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These basic snippets currently work on Grayskull only. We are working on
updating the API for other architectures, like Wormhole.</p>
</div>
<section id="basic-examples">
<h2>Basic Examples<a class="headerlink" href="#basic-examples" title="Permalink to this heading"></a>
</h2>
<section id="converting-from-and-to-torch-tensor">
<h3>1. Converting from and to torch tensor<a class="headerlink" href="#converting-from-and-to-torch-tensor" title="Permalink to this heading"></a>
</h3>
</section>
<section id="running-an-operation-on-the-device">
<h3>2. Running an operation on the device<a class="headerlink" href="#running-an-operation-on-the-device" title="Permalink to this heading"></a>
</h3>
</section>
<section id="using-getitem-to-slice-the-tensor">
<h3>3. Using __getitem__ to slice the tensor<a class="headerlink" href="#using-getitem-to-slice-the-tensor" title="Permalink to this heading"></a>
</h3>
</section>
<section id="enabling-program-cache">
<h3>4. Enabling program cache<a class="headerlink" href="#enabling-program-cache" title="Permalink to this heading"></a>
</h3>
</section>
<section id="debugging-intermediate-tensors">
<h3>5. Debugging intermediate tensors<a class="headerlink" href="#debugging-intermediate-tensors" title="Permalink to this heading"></a>
</h3>
</section>
<section id="tracing-the-graph-of-operations">
<h3>6. Tracing the graph of operations<a class="headerlink" href="#tracing-the-graph-of-operations" title="Permalink to this heading"></a>
</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This basic snippet is under construction, and may not work on all hardware architectures.</p>
</div>
<div class="highlight-python notranslate">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">ttnn</span>

<span class="n">device_id</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">open_device</span><span class="p">(</span><span class="n">device_id</span><span class="o">=</span><span class="n">device_id</span><span class="p">)</span>

<span class="k">with</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">tracer</span><span class="o">.</span><span class="n">trace</span><span class="p">():</span>
    <span class="n">torch_input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
    <span class="n">input_tensor</span> <span class="o">=</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">from_torch</span><span class="p">(</span><span class="n">torch_input_tensor</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ttnn</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">ttnn</span><span class="o">.</span><span class="n">TILE_LAYOUT</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
    <span class="n">output_tensor</span> <span class="o">=</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span>
    <span class="n">torch_output_tensor</span> <span class="o">=</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">to_torch</span><span class="p">(</span><span class="n">output_tensor</span><span class="p">)</span>
<span class="n">ttnn</span><span class="o">.</span><span class="n">tracer</span><span class="o">.</span><span class="n">visualize</span><span class="p">(</span><span class="n">torch_output_tensor</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">"exp_trace.svg"</span><span class="p">)</span>

<span class="n">ttnn</span><span class="o">.</span><span class="n">close_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="using-tt-lib-operation-in-ttnn">
<h3>7. Using tt_lib operation in ttnn<a class="headerlink" href="#using-tt-lib-operation-in-ttnn" title="Permalink to this heading"></a>
</h3>
<p><cite>tt_lib</cite> operations are missing some of the features of ttnn operations such as graph tracing and in order to support these features, ttnn provides a different to call <cite>tt_lib</cite> operations that enabled the missing features.</p>
<p><cite>tt_lib</cite> operations are missing some of the features of ttnn operations such as graph tracing and in order to support these features, ttnn provides a different to call <cite>tt_lib</cite> operations that enabled the missing features.</p>
</section>
<section id="enabling-logging">
<h3>8. Enabling Logging<a class="headerlink" href="#enabling-logging" title="Permalink to this heading"></a>
</h3>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span><span class="c1"># To print currently executing ttnn operations</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">TTNN_CONFIG_OVERRIDES</span><span class="o">=</span><span class="s1">'{"enable_fast_runtime_mode": false, "enable_logging": true}'</span>

<span class="c1"># To generate a csv with all of the ttnn and tt_lib operations, their attributes and their input tensors:</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">OPERATION_HISTORY_CSV</span><span class="o">=</span>operation_history.csv

<span class="c1"># To print the currently executing ttnn and tt_lib operation and its input tensors to stdout</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">TT_METAL_LOGGER_TYPES</span><span class="o">=</span>Op
<span class="nb">export</span><span class="w"> </span><span class="nv">TT_METAL_LOGGER_LEVEL</span><span class="o">=</span>Debug
</pre></div>
</div>
<p>Logging is not a substitute for profiling.
Please refer to <a class="reference internal" href="profiling_ttnn_operations.html"><span class="doc">Profiling ttnn Operations</span></a> for instructions on how to profile operations.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The logging is only available when compiling with CONFIG=assert or CONFIG=debug.</p>
</div>
</section>
<section id="supported-python-operators">
<h3>9. Supported Python Operators<a class="headerlink" href="#supported-python-operators" title="Permalink to this heading"></a>
</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This basic snippet is under construction, and may not work on all hardware architectures.</p>
</div>
<div class="highlight-python notranslate">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ttnn</span>

<span class="n">input_tensor_a</span><span class="p">:</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">from_torch</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ttnn</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">ttnn</span><span class="o">.</span><span class="n">TILE_LAYOUT</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>
<span class="n">input_tensor_b</span><span class="p">:</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">Tensor</span> <span class="o">=</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">from_torch</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ttnn</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">ttnn</span><span class="o">.</span><span class="n">TILE_LAYOUT</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

<span class="c1"># Add (supports broadcasting)</span>
<span class="n">input_tensor_a</span> <span class="o">+</span> <span class="n">input_tensor_b</span>

<span class="c1"># Subtract (supports broadcasting)</span>
<span class="n">input_tensor_a</span> <span class="o">-</span> <span class="n">input_tensor_b</span>

<span class="c1"># Multiply (supports broadcasting)</span>
<span class="n">input_tensor_a</span> <span class="o">-</span> <span class="n">input_tensor_b</span>

<span class="c1"># Matrix Multiply</span>
<span class="n">input_tensor_a</span> <span class="o">@</span> <span class="n">input_tensor_b</span>

<span class="c1"># Equals</span>
<span class="n">input_tensor_a</span> <span class="o">==</span> <span class="n">input_tensor_b</span>

<span class="c1"># Not equals</span>
<span class="n">input_tensor_a</span> <span class="o">!=</span> <span class="n">input_tensor_b</span>

<span class="c1"># Greater than</span>
<span class="n">input_tensor_a</span> <span class="o">&gt;</span> <span class="n">input_tensor_b</span>

<span class="c1"># Greater than or equals</span>
<span class="n">input_tensor_a</span> <span class="o">&gt;=</span> <span class="n">input_tensor_b</span>

<span class="c1"># Less than</span>
<span class="n">input_tensor_a</span> <span class="o">&lt;</span> <span class="n">input_tensor_b</span>

<span class="c1"># Less than or equals</span>
<span class="n">input_tensor_a</span> <span class="o">&lt;=</span> <span class="n">input_tensor_b</span>
</pre></div>
</div>
</section>
<section id="changing-the-string-representation-of-the-tensor">
<h3>10. Changing the string representation of the tensor<a class="headerlink" href="#changing-the-string-representation-of-the-tensor" title="Permalink to this heading"></a>
</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This basic snippet is under construction, and may not work on all hardware architectures.</p>
</div>
</section>
<section id="visualize-using-web-browser">
<h3>11. Visualize using Web Browser<a class="headerlink" href="#visualize-using-web-browser" title="Permalink to this heading"></a>
</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This basic snippet is under construction, and may not work on all hardware architectures.</p>
</div>
<p>Set the following environment variables as needed</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span><span class="c1"># enable_fast_runtime_mode - This has to be disabled to enable logging</span>
<span class="c1"># enable_logging - Synchronize main thread after every operation and log the operation</span>
<span class="c1"># report_name (optional) - Name of the report used by the visualizer. If not provided, then no data will be dumped to disk</span>
<span class="c1"># enable_detailed_buffer_report (if report_name is set) - Enable to visualize the detailed buffer report after every operation</span>
<span class="c1"># enable_graph_report (if report_name is set) - Enable to visualize the graph after every operation</span>
<span class="c1"># enable_detailed_tensor_report (if report_name is set) - Enable to visualize the values of input and output tensors of every operation</span>
<span class="c1"># enable_comparison_mode (if report_name is set) - Enable to test the output of operations against their golden implementaiton</span>


<span class="w"> </span><span class="c1"># If running a pytest that is located inside of tests/ttnn, use this config (unless you want to override "report_name" manually)</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">TTNN_CONFIG_OVERRIDES</span><span class="o">=</span><span class="s1">'{</span>
<span class="s1">    "enable_fast_runtime_mode": false,</span>
<span class="s1">    "enable_logging": true,</span>
<span class="s1">    "enable_graph_report": false,</span>
<span class="s1">    "enable_detailed_buffer_report": false,</span>
<span class="s1">    "enable_detailed_tensor_report": false,</span>
<span class="s1">    "enable_comparison_mode": false</span>
<span class="s1">}'</span>

<span class="c1"># Otherwise, use this config and make sure to set "report_name"</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">TTNN_CONFIG_OVERRIDES</span><span class="o">=</span><span class="s1">'{</span>
<span class="s1">    "enable_fast_runtime_mode": false,</span>
<span class="s1">    "enable_logging": true,</span>
<span class="s1">    "report_name": "&lt;name of the run in the visualizer&gt;",</span>
<span class="s1">    "enable_graph_report": false,</span>
<span class="s1">    "enable_detailed_buffer_report": false,</span>
<span class="s1">    "enable_detailed_tensor_report": false,</span>
<span class="s1">    "enable_comparison_mode": false</span>
<span class="s1">}'</span>

<span class="c1"># Additionally, a json file can be used to override the config values</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">TTNN_CONFIG_PATH</span><span class="o">=</span>&lt;path<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>file&gt;
</pre></div>
</div>
<p>Run the code. i.e.:</p>
<p>Open the visualizer by running the following command:</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span>python<span class="w"> </span>ttnn/visualizer/app.py
</pre></div>
</div>
</section>
<section id="register-pre-and-or-post-operation-hooks">
<h3>12. Register pre- and/or post-operation hooks<a class="headerlink" href="#register-pre-and-or-post-operation-hooks" title="Permalink to this heading"></a>
</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This basic snippet is under construction, and may not work on all hardware architectures.</p>
</div>
<div class="highlight-python notranslate">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">ttnn</span>

<span class="n">device_id</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">device</span> <span class="o">=</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">open_device</span><span class="p">(</span><span class="n">device_id</span><span class="o">=</span><span class="n">device_id</span><span class="p">)</span>

<span class="n">torch_input_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">bfloat16</span><span class="p">)</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">from_torch</span><span class="p">(</span><span class="n">torch_input_tensor</span><span class="p">,</span> <span class="n">layout</span><span class="o">=</span><span class="n">ttnn</span><span class="o">.</span><span class="n">TILE_LAYOUT</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">pre_hook_to_print_args_and_kwargs</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Pre-hook called for </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">. Args: </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">, kwargs: </span><span class="si">{</span><span class="n">kwargs</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">post_hook_to_print_output</span><span class="p">(</span><span class="n">operation</span><span class="p">,</span> <span class="n">args</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">,</span> <span class="n">output</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Post-hook called for </span><span class="si">{</span><span class="n">operation</span><span class="si">}</span><span class="s2">. Output: </span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>

<span class="k">with</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">register_pre_operation_hook</span><span class="p">(</span><span class="n">pre_hook_to_print_args_and_kwargs</span><span class="p">),</span> <span class="n">ttnn</span><span class="o">.</span><span class="n">register_post_operation_hook</span><span class="p">(</span><span class="n">post_hook_to_print_output</span><span class="p">):</span>
    <span class="n">ttnn</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">ttnn</span><span class="o">.</span><span class="n">close_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="query-all-operations">
<h3>13. Query all operations<a class="headerlink" href="#query-all-operations" title="Permalink to this heading"></a>
</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This basic snippet is under construction, and may not work on all hardware architectures.</p>
</div>
<div class="highlight-python notranslate">
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ttnn</span>
<span class="n">ttnn</span><span class="o">.</span><span class="n">query_registered_operations</span><span class="p">()</span>
</pre></div>
</div>
</section>
<section id="disable-fallbacks">
<h3>14. Disable Fallbacks<a class="headerlink" href="#disable-fallbacks" title="Permalink to this heading"></a>
</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This basic snippet is under construction, and may not work on all hardware architectures.</p>
</div>
<p>Fallbacks are used when the operation is not supported by the device. The fallbacks are implemented in the host and are slower than the device operations.
The user will be notified when a fallback is used. The fallbacks can be disabled by setting the following environment variable.</p>
<div class="highlight-bash notranslate">
<div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">TTNN_THROW_EXCEPTION_ON_FALLBACK</span><span class="o">=</span>True
</pre></div>
</div>
</section>
</section>
</section>



           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="get_started.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tensor.html" class="btn btn-neutral float-right" title="Tensor" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright Tenstorrent.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  
<div class="rst-versions" data-toggle="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
        Version: latest
        <span class="fa fa-caret-down"></span>
    </span>
    <div class="rst-other-versions">
        
        <dl>
            <dt>Versions</dt>
            
            <dd><a href="https://tenstorrent.github.io/docs-test/ttnn/latest/index.html">latest</a></dd>
            
            <dd><a href="https://tenstorrent.github.io/docs-test/ttnn/v0.49.0/index.html">v0.49.0</a></dd>
            
        </dl>
        
        <br>
        </dl>
    </div>
</div>
<script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>